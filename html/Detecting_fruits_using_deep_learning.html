<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title> Fruit recognition from images using deep learning </title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html --> 
<meta name="src" content="Detecting_fruits_using_deep_learning.tex"> 
<link rel="stylesheet" type="text/css" href="Detecting_fruits_using_deep_learning.css"> 
</head><body 
>
  <div class="maketitle">
                                                                    

                                                                    
                                                                    

                                                                    
<div class="minipage">
</div> <div class="minipage"><div  
class="centerline">              <span 
class="pxsc-x-x-110">A<span 
class="small-caps">C</span><span 
class="small-caps">T</span><span 
class="small-caps">A</span> U<span 
class="small-caps">N</span><span 
class="small-caps">I</span><span 
class="small-caps">V</span>. S<span 
class="small-caps">A</span><span 
class="small-caps">P</span><span 
class="small-caps">I</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span><span 
class="small-caps">T</span><span 
class="small-caps">I</span><span 
class="small-caps">A</span><span 
class="small-caps">E</span>, I<span 
class="small-caps">N</span><span 
class="small-caps">F</span><span 
class="small-caps">O</span><span 
class="small-caps">R</span><span 
class="small-caps">M</span><span 
class="small-caps">A</span><span 
class="small-caps">T</span><span 
class="small-caps">I</span><span 
class="small-caps">C</span><span 
class="small-caps">A</span>, </span><span 
class="pxb-x-x-109">10, </span>1 (2018) 26&#8211;42              </div>
</div> <br 
class="newline" />____________________________________________________________________

<h2 class="titleHead">  Fruit recognition from images using deep
learning </h2> <span class="thank-mark"><a 
href="#tk-0"></a></span>
   <div class="thanks" ><br /><a 
 id="tk-0"></a><span class="thank-mark"></span><span 
class="pxb-x-x-109">Computing Classification System 1998: </span>I.2.6
    <span 
class="pxb-x-x-109">Mathematics Subject Classification 2010: </span>68T45
    <span 
class="pxb-x-x-109">Key words and phrases: </span>Deep learning, Object recognition, Computer vision
</div></div>
<div class="center" 
>
<!--l. 104--><p class="noindent" >
<!--l. 104--><p class="noindent" ><div class="minipage"><div class="center" 
>
<!--l. 104--><p class="noindent" >
<!--l. 104--><p class="noindent" ><span 
class="pxr-x-x-144">Horea Mure</span><span 
class="pxr-x-x-144">&#351;an</span><br />
<a 
href="http://www.cs.ubbcluj.ro/" ><span 
class="pxr-">Faculty of Mathematics and Computer</span>
<span 
class="pxr-">Science</span><br />
<span 
class="pxr-">Mihail Kog</span><span 
class="pxr-">&#x01CE;lniceanu, 1</span><br />
<span 
class="pxr-">Babe</span><span 
class="pxr-">&#351;-Bolyai University</span><br />
<span 
class="pxr-">Romania</span></a><br />
<span 
class="pxr-">email: </span><a 
href="mailto:horea94@gmail.com" ><span 
class="txtt-">horea94@gmail.com</span></a>
</div></div>&#x00A0;      <div class="minipage"><div class="center" 
>
<!--l. 104--><p class="noindent" >
<!--l. 104--><p class="noindent" ><a 
href="https://mihaioltean.github.io/" ><span 
class="pxr-x-x-144">Mihai Oltean</span></a><br />
<a 
href="http://stiinteexacte.uab.ro/" ><span 
class="pxr-">Faculty of Exact Sciences and</span>
<span 
class="pxr-">Engineering</span><br />
<span 
class="pxr-">Unirii, 15-17</span><br />
<span 
class="pxr-">&#8221;1 Decembrie 1918&#8221; University of Alba</span>
<span 
class="pxr-">Iulia</span><br />
<span 
class="pxr-">Romania</span></a><br />
<span 
class="pxr-">email: </span><a 
href="mailto:mihai.oltean@gmail.com" ><span 
class="txtt-">mihai.oltean@gmail.com</span></a>
</div></div></div>
                                                                    

                                                                    
<div 
class="abstract" 
>
<!--l. 105--><p class="indent" >  <center class="quotation"><table class="quotation" 
border="0" cellpadding="0" cellspacing="15"><tr><td>
        <div class="quotation">
     <!--l. 105--><p class="noindent" ><span 
class="pxb-">Abstract.</span>
     <!--l. 107--><p class="indent" >       <span 
class="pxr-">In this paper we introduce a new, high-quality, dataset of images</span>
     <span 
class="pxr-">containing  fruits.  We  also  present  the  results  of  some  numerical</span>
     <span 
class="pxr-">experiment for training a neural network to detect fruits. We discuss</span>
     <span 
class="pxr-">the reason why we chose to use fruits in this project by proposing a</span>
     <span 
class="pxr-">few applications that could use such classifier.</span>
     <!--l. 111--><p class="noindent" ><span 
class="pxb-">Keywords:  </span><span 
class="pxmi-">Deep learning</span><span 
class="pxr-">,  </span><span 
class="pxmi-">Object recognition</span><span 
class="pxr-">,  </span><span 
class="pxmi-">Computer vision</span><span 
class="pxr-">,  </span><span 
class="pxmi-">fruits</span>
     <span 
class="pxmi-">dataset</span><span 
class="pxr-">, </span><span 
class="pxmi-">image processing</span>
        </div>
<!--l. 114--><p class="noindent" ></td></tr></table></center>
</div>
  <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
  <div class="tableofcontents">
  <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Introduction</a></span>
<br />  <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">Related work</a></span>
<br />  <span class="sectionToc" >3 <a 
href="#x1-40003" id="QQ2-1-4">Deep learning</a></span>
<br />  &#x00A0;<span class="subsectionToc" >3.1 <a 
href="#x1-50003.1" id="QQ2-1-5">Convolutional neural networks</a></span>
<br />  &#x00A0;&#x00A0;<span class="subsubsectionToc" >3.1.1 <a 
href="#x1-60003.1.1" id="QQ2-1-6">Convolutional layers</a></span>
<br />  &#x00A0;&#x00A0;<span class="subsubsectionToc" >3.1.2 <a 
href="#x1-70003.1.2" id="QQ2-1-7">Pooling layers</a></span>
<br />  &#x00A0;&#x00A0;<span class="subsubsectionToc" >3.1.3 <a 
href="#x1-80003.1.3" id="QQ2-1-8">Fully connected layers</a></span>
<br />  &#x00A0;&#x00A0;<span class="subsubsectionToc" >3.1.4 <a 
href="#x1-90003.1.4" id="QQ2-1-9">Loss layers</a></span>
<br />  &#x00A0;<span class="subsectionToc" >3.2 <a 
href="#x1-100003.2" id="QQ2-1-10">Recurrent neural network</a></span>
<br />  &#x00A0;<span class="subsectionToc" >3.3 <a 
href="#x1-110003.3" id="QQ2-1-11">Deep belief network</a></span>
<br />  <span class="sectionToc" >4 <a 
href="#x1-120004" id="QQ2-1-12">Fruits-360 data set</a></span>
<br />  <span class="sectionToc" >5 <a 
href="#x1-130005" id="QQ2-1-15">TensorFlow library</a></span>
<br />  <span class="sectionToc" >6 <a 
href="#x1-140006" id="QQ2-1-16">The structure of the neural network used in experiments</a></span>
<br />  <span class="sectionToc" >7 <a 
href="#x1-150007" id="QQ2-1-19">Numerical experiments</a></span>
<br />  <span class="sectionToc" >8 <a 
href="#x1-160008" id="QQ2-1-24">Conclusions and further work</a></span>
  </div>
                                                                    

                                                                    
<!--l. 118--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">1    </span> <a 
 id="x1-20001"></a>Introduction</h3>
<!--l. 120--><p class="noindent" >The aim of this paper is to propose a new dataset of images containing popular
fruits. The dataset was named Fruits-360 and can be downloaded from the
addresses pointed by references <span class="cite">[<a 
href="#Xfruits_360_github">18</a>]</span> and <span class="cite">[<a 
href="#Xfruits_360_kaggle">19</a>]</span>. Currently (as of 2018.12.22) the set
contains 61934 images of 90 fruits and it is constantly updated with images of
new fruits as soon as the authors have accesses to them. The reader is
encouraged to access the latest version of the dataset from the above indicated
addresses.
<!--l. 122--><p class="indent" >  Having a high-quality dataset is essential for obtaining a good classifier. Most
of the existing datasets with images (see for instance the popular CIFAR dataset
<span class="cite">[<a 
href="#Xcifar">12</a>]</span>) contain both the object and the noisy background. This could lead to cases
where changing the background will lead to the incorrect classification of the
object.
<!--l. 124--><p class="indent" >  As a second objective we have trained a deep neural network that is capable of
identifying fruits from images. This is part of a more complex project that
has the target of obtaining a classifier that can identify a much wider
array of objects from images. This fits the current trend of companies
working in the augmented reality field. During its annual I/O conference,
Google announced <span class="cite">[<a 
href="#Xlens">21</a>]</span> that is working on an application named Google
Lens which will tell the user many useful information about the object
toward which the phone camera is pointing. First step in creating such
application is to correctly identify the objects. The software has been released
later in 2017 as a feature of Google Assistant and Google Photos apps.
Currently the identification of objects is based on a deep neural network
<span class="cite">[<a 
href="#Xgoogle_lens_wikipedia">35</a>]</span>.
<!--l. 126--><p class="indent" >  Such a network would have numerous applications across multiple
domains like autonomous navigation, modeling objects, controlling
processes or human-robot interactions. The area we are most interested in is
creating an autonomous robot that can perform more complex tasks than a
regular industrial robot. An example of this is a robot that can perform
inspections on the aisles of stores in order to identify out of place items or
understocked shelves. Furthermore, this robot could be enhanced to be
able to interact with the products so that it can solve the problems on
its own. Another area in which this research can provide benefits is
autonomous fruit harvesting. While there are several papers on this topic
already, from the best of our knowledge, they focus on few species of fruits
or vegetables. In this paper we attempt to create a network that can
                                                                    

                                                                    
classify a variety of species of fruit, thus making it useful in many more
scenarios.
<!--l. 128--><p class="indent" >  As the start of this project we chose the task of identifying fruits for several
reasons. On one side, fruits have certain categories that are hard to differentiate,
like the citrus genus, that contains oranges and grapefruits. Thus we
want to see how well can an artificial intelligence complete the task of
classifying them. Another reason is that fruits are very often found in stores,
so they serve as a good starting point for the previously mentioned
project.
<!--l. 130--><p class="indent" >  The paper is structured as follows: in the first part we will shortly discuss a
few outstanding achievements obtained using deep learning for fruits
recognition, followed by a presentation of the concept of deep learning. In the
second part we describe the Fruits-360 dataset: how it was created and what it
contains. In the third part we will present the framework used in this project -
TensorFlow<span class="cite">[<a 
href="#Xtf">32</a>]</span> and the reasons we chose it. Following the framework
presentation, we will detail the structure of the neural network that we
used. We also describe the training and testing data used as well as the
obtained performance. Finally, we will conclude with a few plans on
how to improve the results of this project. Source code is listed in the
Appendix.
<!--l. 132--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">2    </span> <a 
 id="x1-30002"></a>Related work</h3>
<!--l. 134--><p class="noindent" >In this section we review several previous attempts to use neural networks and
deep learning for fruits recognition.
<!--l. 136--><p class="indent" >  A method for recognizing and counting fruits from images in cluttered
greenhouses is presented in <span class="cite">[<a 
href="#Xauto_counting">28</a>]</span>. The targeted plants are peppers with fruits of
complex shapes and varying colors similar to the plant canopy. The aim of the
application is to locate and count green and red pepper fruits on large, dense
pepper plants growing in a greenhouse. The training and validation
data used in this paper consists of 28000 images of over 1000 plants
and their fruits. The used method to locate and count the peppers is
two-step: in the first step, the fruits are located in a single image and in a
second step multiple views are combined to increase the detection rate of
the fruits. The approach to find the pepper fruits in a single image is
based on a combination of (1) finding points of interest, (2) applying a
complex high-dimensional feature descriptor of a patch around the point
                                                                    

                                                                    
of interest and (3) using a so-called bag-of-words for classifying the
patch.
<!--l. 138--><p class="indent" >  Paper <span class="cite">[<a 
href="#Xdeep_fruits">25</a>]</span> presents a novel approach for detecting fruits from images using
deep neural networks. For this purpose the authors adapt a Faster Region-based
convolutional network. The objective is to create a neural network that would be
used by autonomous robots that can harvest fruits. The network is trained using
RGB and NIR (near infra red) images. The combination of the RGB and NIR
models is done in 2 separate cases: early and late fusion. Early fusion implies
that the input layer has 4 channels: 3 for the RGB image and one for the NIR
image. Late fusion uses 2 independently trained models that are merged by
obtaining predictions from both models and averaging the results. The result is a
multi modal network which obtains much better performance than the existing
networks.
<!--l. 140--><p class="indent" >  On the topic of autonomous robots used for harvesting, paper <span class="cite">[<a 
href="#Xorchards">1</a>]</span> shows a
network trained to recognize fruits in an orchard. This is a particularly difficult
task because in order to optimize operations, images that span many fruit
trees must be used. In such images, the amount of fruits can be large,
in the case of almonds up to 1500 fruits per image. Also, because the
images are taken outside, there is a lot of variance in luminosity, fruit size,
clustering and view point. Like in paper <span class="cite">[<a 
href="#Xdeep_fruits">25</a>]</span>, this project makes use of the
Faster Region-based convolutional network, which is presented in a
detailed view in paper <span class="cite">[<a 
href="#Xrcnn">24</a>]</span>. Related to the automatic harvest of fruits,
article <span class="cite">[<a 
href="#Xauto_harvest">22</a>]</span> presents a method of detecting ripe strawberries and apples
from orchards. The paper also highlights existing methods and their
performance.
<!--l. 142--><p class="indent" >  In <span class="cite">[<a 
href="#Xrobot_harvest">11</a>]</span> the authors compile a list of the available state of the art methods for
harvesting with the aid of robots. They also analyze the method and propose
ways to improve them.
<!--l. 144--><p class="indent" >  In <span class="cite">[<a 
href="#Xdata_synthesis">2</a>]</span> one can see a method of generating synthetic images that are highly
similar to empirical images. Specifically, this paper introduces a method for the
generation of large-scale semantic segmentation datasets on a plant-part
level of realistic agriculture scenes, including automated per-pixel class
and depth labeling. One purpose of such synthetic dataset would be to
bootstrap or pre-train computer vision models, which are fine-tuned
thereafter on a smaller empirical image dataset. Similarly, in paper <span class="cite">[<a 
href="#Xfruit_count">23</a>]</span>
we can see a network trained on synthetic images that can count the
number of fruits in images without actually detecting where they are in the
image.
                                                                    

                                                                    
<!--l. 146--><p class="indent" >  Another paper, <span class="cite">[<a 
href="#Xyield_prediction">4</a>]</span>, uses two back propagation neural networks trained on
images with apple &#8221;Gala&#8221; variety trees in order to predict the yield for the
upcoming season. For this task, four features have been extracted from images:
total cross-sectional area of fruits, fruit number, total cross-section area of small
fruits, and cross-sectional area of foliage.
<!--l. 148--><p class="indent" >  Paper <span class="cite">[<a 
href="#Xcamera_angles">10</a>]</span> presents an analysis of fruit detectability in relation to the angle of
the camera when the image was taken. Based on this research, it was concluded
that the fruit detectability was the highest on front views and looking with a
zenith angle of 60<sup><span 
class="pxsy-x-x-80">&#x2218;</span></sup> upwards.
<!--l. 150--><p class="indent" >  In papers <span class="cite">[<a 
href="#Xcolor_texture">27</a>,&#x00A0;<a 
href="#Xcolor_shape_feat">37</a>,&#x00A0;<a 
href="#Xcucumber">15</a>]</span> we can see an approach to detecting fruits based on
color, shape and texture. They highlight the difficulty of correctly classifying
similar fruits of different species. They propose combining existing methods
using the texture, shape and color of fruits to detect regions of interest from
images. Similarly, in <span class="cite">[<a 
href="#Xk_nearest_fruits">20</a>]</span> a method combining shape, size and color, texture of
the fruits together with a k nearest neighbor algorithm is used to increase the
accuracy of recognition.
<!--l. 152--><p class="indent" >  One of the most recent works <span class="cite">[<a 
href="#Xgreen_grape">36</a>]</span> presents an algorithm based on the
improved Chan&#8211;Vese level-set model <span class="cite">[<a 
href="#Xchan">3</a>]</span> and combined with the level-set idea
and M-S mode <span class="cite">[<a 
href="#Xmumford">17</a>]</span>. The proposed goal was to conduct night-time green grape
detection. Combining the principle of the minimum circumscribed rectangle of
fruit and the method of Hough straight-line detection, the picking point of the
fruit stem was calculated.
<!--l. 154--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">3    </span> <a 
 id="x1-40003"></a>Deep learning</h3>
<!--l. 156--><p class="noindent" >In the area of image recognition and classification, the most successful results
were obtained using artificial neural networks <span class="cite">[<a 
href="#Xhigh_perf_conv">6</a>,&#x00A0;<a 
href="#Xvery_deep">30</a>]</span>. These networks form the
basis for most deep learning models.
<!--l. 158--><p class="indent" >  Deep learning is a class of machine learning algorithms that use multiple
layers that contain nonlinear processing units <span class="cite">[<a 
href="#Xoverview">26</a>]</span>. Each level learns to transform
its input data into a slightly more abstract and composite representation <span class="cite">[<a 
href="#Xhigh_perf_conv">6</a>]</span>.
Deep neural networks have managed to outperform other machine learning
algorithms. They also achieved the first superhuman pattern recognition
in certain domains <span class="cite">[<a 
href="#Xsuperhuman_network">5</a>]</span>. This is further reinforced by the fact that deep
learning is considered as an important step towards obtaining Strong
AI. Secondly, deep neural networks - specifically convolutional neural
networks - have been proved to obtain great results in the field of image
                                                                    

                                                                    
recognition.
<!--l. 160--><p class="indent" >  In the rest of this section we will briefly describe some models of
deep artificial neural networks along with some results for some related
problems.
<!--l. 162--><p class="noindent" >
  <h4 class="subsectionHead"><span class="titlemark">3.1    </span> <a 
 id="x1-50003.1"></a>Convolutional neural networks</h4>
<!--l. 163--><p class="noindent" >Convolutional neural networks (CNN) are part of the deep learning models.
Such a network can be composed of convolutional layers, pooling layers, ReLU
layers, fully connected layers and loss layers <span class="cite">[<a 
href="#Xdl">34</a>]</span>. In a typical CNN architecture,
each convolutional layer is followed by a Rectified Linear Unit (ReLU) layer,
then a Pooling layer then one or more convolutional layer and finally one or
more fully connected layer. A characteristic that sets apart the CNN from a
regular neural network is taking into account the structure of the images while
processing them. Note that a regular neural network converts the input in a one
dimensional array which makes the trained classifier less sensitive to positional
changes.
<!--l. 165--><p class="indent" >  Among the best results obtained on the MNIST <span class="cite">[<a 
href="#Xmnist">13</a>]</span> dataset is done by using
multi-column deep neural networks. As described in paper <span class="cite">[<a 
href="#Xmulti_column">7</a>]</span>, they use
multiple maps per layer with many layers of non-linear neurons. Even if the
complexity of such networks makes them harder to train, by using graphical
processors and special code written for them. The structure of the network uses
winner-take-all neurons with max pooling that determine the winner
neurons.
<!--l. 167--><p class="indent" >  Another paper <span class="cite">[<a 
href="#Xrecurrent_conv">16</a>]</span> further reinforces the idea that convolutional networks
have obtained better accuracy in the domain of computer vision. In paper <span class="cite">[<a 
href="#Xall_conv">29</a>]</span> an
all convolutional network that gains very good performance on CIFAR-10 <span class="cite">[<a 
href="#Xcifar">12</a>]</span> is
described in detail. The paper proposes the replacement of pooling and fully
connected layers with equivalent convolutional ones. This may increase the
number of parameters and adds inter-feature dependencies however it can be
mitigated by using smaller convolutional layers within the network and acts as a
form of regularization.
<!--l. 169--><p class="indent" >  In what follows we will describe each of the layers of a CNN network.
<!--l. 171--><p class="noindent" >
  <h5 class="subsubsectionHead"><span class="titlemark">3.1.1    </span> <a 
 id="x1-60003.1.1"></a>Convolutional layers</h5>
                                                                    

                                                                    
<!--l. 172--><p class="noindent" >Convolutional layers are named after the convolution operation. In mathematics
convolution is an operation on two functions that produces a third function that
is the modified (convoluted) version of one of the original functions. The
resulting function gives in integral of the pointwise multiplication of the two
functions as a function of the amount that one of the original functions is
translated <span class="cite">[<a 
href="#Xconv">33</a>]</span>.
<!--l. 174--><p class="indent" >  A convolutional layer consists of groups of neurons that make up kernels. The
kernels have a small size but they always have the same depth as the input. The
neurons from a kernel are connected to a small region of the input, called the
receptive field, because it is highly inefficient to link all neurons to all previous
outputs in the case of inputs of high dimensions such as images. For example, a
100 x 100 image has 10000 pixels and if the first layer has 100 neurons, it
would result in 1000000 parameters. Instead of each neuron having
weights for the full dimension of the input, a neuron holds weights for the
dimension of the kernel input. The kernels slide across the width and height
of the input, extract high level features and produce a 2 dimensional
activation map. The stride at which a kernel slides is given as a parameter.
The output of a convolutional layer is made by stacking the resulted
activation maps which in turned is used to define the input of the next
layer.
<!--l. 176--><p class="indent" >  Applying a convolutional layer over an image of size 32 X 32 results in an
activation map of size 28 X 28. If we apply more convolutional layers, the size
will be further reduced, and, as a result the image size is drastically reduced
which produces loss of information and the vanishing gradient problem. To
correct this, we use padding. Padding increases the size of a input data by filling
constants around input data. In most of the cases, this constant is zero so the
operation is named zero padding. &#8221;Same&#8221; padding means that the output
feature map has the same spatial dimensions as the input feature map. This tries
to pad evenly left and right, but if the number of columns to be added is odd, it
will add an extra column to the right. &#8221;Valid&#8221; padding is equivalent to no
padding.
<!--l. 178--><p class="indent" >  The strides causes a kernel to skip over pixels in an image and not include
them in the output. The strides determines how a convolution operation works
with a kernel when a larger image and more complex kernel are used. As a
kernel is sliding the input, it is using the strides parameter to determine how
many positions to skip.
<!--l. 180--><p class="indent" >  ReLU layer, or Rectified Linear Units layer, applies the activation function
max(0, x). It does not reduce the size of the network, but it increases its nonlinear
                                                                    

                                                                    
properties.
<!--l. 182--><p class="noindent" >
  <h5 class="subsubsectionHead"><span class="titlemark">3.1.2    </span> <a 
 id="x1-70003.1.2"></a>Pooling layers</h5>
<!--l. 183--><p class="noindent" >Pooling layers are used on one hand to reduce the spatial dimensions of the
representation and to reduce the amount of computation done in the network.
The other use of pooling layers is to control overfitting. The most used pooling
layer has filters of size 2 x 2 with a stride 2. This effectively reduces the input to a
quarter of its original size.
<!--l. 185--><p class="noindent" >
  <h5 class="subsubsectionHead"><span class="titlemark">3.1.3    </span> <a 
 id="x1-80003.1.3"></a>Fully connected layers</h5>
<!--l. 186--><p class="noindent" >Fully connected layers are layers from a regular neural network. Each neuron
from a fully connected layer is linked to each output of the previous layer. The
operations behind a convolutional layer are the same as in a fully connected
layer. Thus, it is possible to convert between the two.
<!--l. 188--><p class="noindent" >
  <h5 class="subsubsectionHead"><span class="titlemark">3.1.4    </span> <a 
 id="x1-90003.1.4"></a>Loss layers</h5>
<!--l. 189--><p class="noindent" >Loss layers are used to penalize the network for deviating from the expected
output. This is normally the last layer of the network. Various loss function exist:
softmax is used for predicting a class from multiple disjunct classes, sigmoid
cross-entropy is used for predicting multiple independent probabilities (from the
[0, 1] interval).
<!--l. 191--><p class="noindent" >
  <h4 class="subsectionHead"><span class="titlemark">3.2    </span> <a 
 id="x1-100003.2"></a>Recurrent neural network</h4>
<!--l. 192--><p class="noindent" >Another deep learning algorithm is the recursive neural network <span class="cite">[<a 
href="#Xrecurrent_conv">16</a>]</span>. The paper
proposes an improvement to the popular convolutional network in the form of a
recurrent convolutional network. In this kind of architecture the same set of
weights is recursively applied over some data. Traditionally, recurrent networks
have been used to process sequential data, handwriting or speech recognition
being the most known examples. By using recurrent convolutional layers with
some max pool layers in between them and a final global max pool layer at the
                                                                    

                                                                    
end several advantages are obtained. Firstly, within a layer, every unit takes into
account the state of units in an increasingly larger area around it. Secondly, by
having recurrent layers, the depth of the network is increased without adding
more parameters. Recurrent networks have shown good results in natural
language processing.
<!--l. 194--><p class="noindent" >
  <h4 class="subsectionHead"><span class="titlemark">3.3    </span> <a 
 id="x1-110003.3"></a>Deep belief network</h4>
<!--l. 195--><p class="noindent" >Yet another model that is part of the deep learning algorithms is the deep belief
network <span class="cite">[<a 
href="#Xdeep_belief">14</a>]</span>. A deep belief network is a probabilistic model composed by
multiple layers of hidden units. The usages of a deep belief network
are the same as the other presented networks but can also be used to
pre-train a deep neural network in order to improve the initial values of the
weights. This process is important because it can improve the quality of the
network and can reduce training times. Deep belief networks can be
combined with convolutional ones in order to obtain convolutional deep
belief networks which exploit the advantages offered by both types of
architectures.
<!--l. 197--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">4    </span> <a 
 id="x1-120004"></a>Fruits-360 data set</h3>
<!--l. 199--><p class="noindent" >In this section we describe how the data set was created and what it
contains.
<!--l. 201--><p class="indent" >  The images were obtained by filming the fruits while they are rotated by a
motor and then extracting frames.
<!--l. 203--><p class="indent" >  Fruits were planted in the shaft of a low speed motor (3 rpm) and a short
movie of 20 seconds was recorded. Behind the fruits we placed a white sheet of
paper as background.
<!--l. 205--><p class="indent" >  <hr class="figure"><div class="figure" 
>
                                                                    

                                                                    
<a 
 id="x1-12001r1"></a>
                                                                    

                                                                    
<!--l. 207--><p class="noindent" ><img 
src="Resources/pomegranate.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">Left-side: original image. Notice the background and the motor
shaft. Right-side: the fruit after the background removal and after it was
scaled down to 100x100 pixels.</span></div><!--tex4ht:label?: x1-12001r1 -->
                                                                    

                                                                    
<!--l. 210--><p class="indent" >  </div><hr class="endfigure">
<!--l. 212--><p class="indent" >  However due to the variations in the lighting conditions, the background was
not uniform and we wrote a dedicated algorithm which extract the fruit from the
background. This algorithm is of flood fill type: we start from each edge of the
image and we mark all pixels there, then we mark all pixels found in the
neighborhood of the already marked pixels for which the distance between
colors is less than a prescribed value. we repeat the previous step until no more
pixels can be marked.
<!--l. 217--><p class="indent" >  All marked pixels are considered as being background (which is then filled
with white) and the rest of pixels are considered as belonging to the
object. The maximum value for the distance between 2 neighbor pixels
is a parameter of the algorithm and is set (by trial and error) for each
movie.
<!--l. 220--><p class="indent" >  Fruits were scaled to fit a 100x100 pixels image. Other datasets (like MNIST)
use 28x28 images, but we feel that small size is detrimental when you have too
similar objects (a red cherry looks very similar to a red apple in small images).
Our future plan is to work with even larger images, but this will require much
more longer training times.
<!--l. 222--><p class="indent" >  To understand the complexity of background-removal process we have
depicted in Figure <a 
href="#x1-12001r1">1<!--tex4ht:ref: Figure1 --></a> a fruit with its original background and after the
background was removed and the fruit was scaled down to 100 x 100
pixels.
<!--l. 224--><p class="indent" >  The resulted dataset has 61934 images of fruits spread across 90 labels. The
data set is available on GitHub <span class="cite">[<a 
href="#Xfruits_360_github">18</a>]</span> and Kaggle <span class="cite">[<a 
href="#Xfruits_360_kaggle">19</a>]</span>. The labels and the number
of images for training are given in Table <a 
href="#x1-12002r1">1<!--tex4ht:ref: fruits_summary_table --></a>.
<a 
 id="x1-12002r1"></a>
  <!--l. 229--><div class="longtable"> <table id="TBL-1" class="longtable" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-1-1g"><col 
id="TBL-1-1"></colgroup><colgroup id="TBL-1-2g"><col 
id="TBL-1-2"></colgroup><colgroup id="TBL-1-3g"><col 
id="TBL-1-3"></colgroup>
                                                                    

                                                                    
<tr  
 style="vertical-align:baseline;" id="TBL-1-1-"><td colspan="3" style="white-space:nowrap; text-align:center;" id="TBL-1-1-1"  
class="td11">    <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><div class="caption" 
><span class="id">Table&#x00A0;1: </span><span  
class="content">Number of images for each fruit. There are multiple
varieties  of  apples  each  of  them  being  considered  as  a
separate object. We did not find the scientific/popular name
for each apple so we labeled with digits (e.g. apple red 1,
apple red 2 etc).</span></div><!--tex4ht:label?: x1-12002r1 -->                                                                              </div>        <a 
 id="x1-12003"></a>
</td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-2-1"  
class="td11"> <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><span 
class="pxb-x-x-109">Label</span></div> </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-2-2"  
class="td11"> <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><span 
class="pxb-x-x-109">Number of training images</span></div> </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-2-3"  
class="td11"> <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><span 
class="pxb-x-x-109">Number of test images</span></div>
</td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-3-1"  
class="td11">       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-4-1"  
class="td11">        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-4-2"  
class="td11">                            </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-4-3"  
class="td11"></td></tr>
<tr  
 style="vertical-align:baseline;" id="TBL-1-14-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-14-1"  
class="td11">   Apple Braeburn      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-14-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-14-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-15-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-15-1"  
class="td11">   Apple Golden 1       </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-15-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-15-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-16-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-16-1"  
class="td11">   Apple Golden 2       </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-16-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-16-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-17-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-17-1"  
class="td11">   Apple Golden 3       </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-17-2"  
class="td11"> 481  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-17-3"  
class="td11"> 161  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-18-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-18-1"  
class="td11"> Apple Granny Smith  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-18-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-18-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-19-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-19-1"  
class="td11">     Apple Red 1          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-19-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-19-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-20-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-20-1"  
class="td11">     Apple Red 2          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-20-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-20-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-21-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-21-1"  
class="td11">     Apple Red 3          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-21-2"  
class="td11"> 429  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-21-3"  
class="td11"> 144  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-22-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-22-1"  
class="td11"> Apple Red Delicious  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-22-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-22-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-23-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-23-1"  
class="td11"> Apple Red Yellow 1   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-23-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-23-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-24-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-24-1"  
class="td11"> Apple Red Yellow 2   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-24-2"  
class="td11"> 672  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-24-3"  
class="td11"> 219  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-25-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-25-1"  
class="td11">       Apricot              </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-25-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-25-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-26-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-26-1"  
class="td11">      Avocado             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-26-2"  
class="td11"> 427  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-26-3"  
class="td11"> 143  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-27-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-27-1"  
class="td11">    Avocado ripe         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-27-2"  
class="td11"> 491  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-27-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-28-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-28-1"  
class="td11">       Banana              </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-28-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-28-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-29-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-29-1"  
class="td11"> Banana Lady Finger   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-29-2"  
class="td11"> 450  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-29-3"  
class="td11"> 152  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-30-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-30-1"  
class="td11">     Banana Red          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-30-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-30-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-31-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-31-1"  
class="td11">     Cactus fruit          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-31-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-31-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-32-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-32-1"  
class="td11">    Cantaloupe 1         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-32-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-32-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-33-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-33-1"  
class="td11">    Cantaloupe 2         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-33-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-33-3"  
class="td11"> 164  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-34-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-34-1"  
class="td11">                    </td>
                                                                    

                                                                    
  </tr>
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-35-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-35-1"  
class="td11">    Carambula         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-35-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-35-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-36-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-36-1"  
class="td11">      Cherry 1            </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-36-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-36-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-37-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-37-1"  
class="td11">      Cherry 2            </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-37-2"  
class="td11"> 738  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-37-3"  
class="td11"> 246  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-38-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-38-1"  
class="td11">   Cherry Rainier      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-38-2"  
class="td11"> 738  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-38-3"  
class="td11"> 246  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-39-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-39-1"  
class="td11">  Cherry Wax Black   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-39-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-39-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-40-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-40-1"  
class="td11">  Cherry Wax Red     </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-40-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-40-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-41-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-41-1"  
class="td11"> Cherry Wax Yellow  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-41-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-41-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-42-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-42-1"  
class="td11">     Chestnut           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-42-2"  
class="td11"> 450  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-42-3"  
class="td11"> 153  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-43-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-43-1"  
class="td11">    Clementine         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-43-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-43-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-44-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-44-1"  
class="td11">       Cocos              </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-44-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-44-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-45-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-45-1"  
class="td11">       Dates              </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-45-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-45-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-46-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-46-1"  
class="td11">     Granadilla          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-46-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-46-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-47-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-47-1"  
class="td11">    Grape Blue         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-47-2"  
class="td11"> 984  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-47-3"  
class="td11"> 328  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-48-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-48-1"  
class="td11">    Grape Pink         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-48-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-48-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-49-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-49-1"  
class="td11">    Grape White        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-49-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-49-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-50-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-50-1"  
class="td11">   Grape White 2      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-50-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-50-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-51-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-51-1"  
class="td11">   Grape White 3      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-51-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-51-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-52-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-52-1"  
class="td11">   Grape White 4      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-52-2"  
class="td11"> 471  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-52-3"  
class="td11"> 158  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-53-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-53-1"  
class="td11">   Grapefruit Pink     </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-53-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-53-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-54-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-54-1"  
class="td11">  Grapefruit White    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-54-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-54-3"  
class="td11"> 164  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-55-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-55-1"  
class="td11">                  </td></tr>
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-56-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-56-1"  
class="td11">      Guava             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-56-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-56-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-57-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-57-1"  
class="td11">    Huckleberry        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-57-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-57-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-58-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-58-1"  
class="td11">       Kaki               </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-58-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-58-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-59-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-59-1"  
class="td11">       Kiwi               </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-59-2"  
class="td11"> 466  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-59-3"  
class="td11"> 156  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-60-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-60-1"  
class="td11">     Kumquats          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-60-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-60-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-61-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-61-1"  
class="td11">      Lemon             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-61-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-61-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-62-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-62-1"  
class="td11">   Lemon Meyer       </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-62-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-62-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-63-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-63-1"  
class="td11">       Limes              </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-63-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-63-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-64-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-64-1"  
class="td11">      Lychee             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-64-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-64-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-65-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-65-1"  
class="td11">     Mandarine         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-65-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-65-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-66-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-66-1"  
class="td11">      Mango             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-66-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-66-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-67-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-67-1"  
class="td11">    Mangostan         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-67-2"  
class="td11"> 300  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-67-3"  
class="td11"> 102  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-68-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-68-1"  
class="td11">     Maracuja           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-68-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-68-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-69-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-69-1"  
class="td11"> Melon Piel de Sapo  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-69-2"  
class="td11"> 738  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-69-3"  
class="td11"> 246  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-70-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-70-1"  
class="td11">     Mulberry           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-70-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-70-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-71-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-71-1"  
class="td11">     Nectarine           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-71-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-71-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-72-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-72-1"  
class="td11">      Orange             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-72-2"  
class="td11"> 479  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-72-3"  
class="td11"> 160  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-73-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-73-1"  
class="td11">      Papaya             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-73-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-73-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-74-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-74-1"  
class="td11">    Passion Fruit        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-74-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-74-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-75-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-75-1"  
class="td11">       Peach              </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-75-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-75-3"  
class="td11"> 164  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-76-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-76-1"  
class="td11">                  </td>
                                                                    

                                                                    
  </tr>
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-77-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-77-1"  
class="td11">      Peach 2             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-77-2"  
class="td11"> 738  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-77-3"  
class="td11"> 246  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-78-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-78-1"  
class="td11">     Peach Flat          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-78-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-78-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-79-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-79-1"  
class="td11">       Pear               </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-79-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-79-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-80-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-80-1"  
class="td11">     Pear Abate          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-80-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-80-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-81-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-81-1"  
class="td11">    Pear Monster        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-81-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-81-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-82-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-82-1"  
class="td11">   Pear Williams       </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-82-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-82-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-83-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-83-1"  
class="td11">      Pepino             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-83-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-83-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-84-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-84-1"  
class="td11">      Physalis            </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-84-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-84-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-85-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-85-1"  
class="td11"> Physalis with Husk  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-85-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-85-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-86-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-86-1"  
class="td11">     Pineapple           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-86-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-86-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-87-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-87-1"  
class="td11">   Pineapple Mini      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-87-2"  
class="td11"> 493  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-87-3"  
class="td11"> 163  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-88-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-88-1"  
class="td11">    Pitahaya Red        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-88-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-88-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-89-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-89-1"  
class="td11">       Plum               </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-89-2"  
class="td11"> 447  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-89-3"  
class="td11"> 151  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-90-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-90-1"  
class="td11">    Pomegranate        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-90-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-90-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-91-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-91-1"  
class="td11">      Quince             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-91-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-91-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-92-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-92-1"  
class="td11">     Rambutan          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-92-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-92-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-93-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-93-1"  
class="td11">     Raspberry          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-93-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-93-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-94-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-94-1"  
class="td11">    Redcurrant         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-94-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-94-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-95-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-95-1"  
class="td11">       Salak               </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-95-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-95-3"  
class="td11"> 162  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-96-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-96-1"  
class="td11">     Strawberry          </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-96-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-96-3"  
class="td11"> 164  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-97-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-97-1"  
class="td11">                   </td></tr>
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-98-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-98-1"  
class="td11"> Strawberry Wedge   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-98-2"  
class="td11"> 738  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-98-3"  
class="td11"> 246  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-99-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-99-1"  
class="td11">     Tamarillo           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-99-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-99-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-100-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-100-1"  
class="td11">      Tangelo             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-100-2"  
class="td11"> 490  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-100-3"  
class="td11"> 166  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-101-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-101-1"  
class="td11">     Tomato 1           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-101-2"  
class="td11"> 738  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-101-3"  
class="td11"> 246  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-102-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-102-1"  
class="td11">     Tomato 2           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-102-2"  
class="td11"> 672  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-102-3"  
class="td11"> 225  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-103-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-103-1"  
class="td11">     Tomato 3           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-103-2"  
class="td11"> 738  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-103-3"  
class="td11"> 246  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-104-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-104-1"  
class="td11">     Tomato 4           </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-104-2"  
class="td11"> 479  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-104-3"  
class="td11"> 160  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-105-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-105-1"  
class="td11"> Tomato Cherry Red  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-105-2"  
class="td11"> 492  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-105-3"  
class="td11"> 164  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-106-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-106-1"  
class="td11">   Tomato Maroon     </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-106-2"  
class="td11"> 367  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-106-3"  
class="td11"> 127  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-107-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-107-1"  
class="td11">      Walnut             </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-107-2"  
class="td11"> 735  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-1-107-3"  
class="td11"> 249  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-108-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-108-1"  
class="td11">                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-109-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-109-1"  
class="td11">                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-110-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-110-1"  
class="td11">                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-111-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-111-1"  
class="td11">                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-112-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-112-1"  
class="td11">                   </td></tr>
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-12-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-12-1"  
class="td11">  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-13-"><td  style="white-space:nowrap; text-align:center;" id="TBL-1-13-1"  
class="td11">  </td></tr>
  </table></div>
                                                                    

                                                                    
  <h3 class="sectionHead"><span class="titlemark">5    </span> <a 
 id="x1-130005"></a>TensorFlow library</h3>
<!--l. 340--><p class="nopar" >For the purpose of implementing, training and testing the network described in
this paper we used the TensorFlow library <span class="cite">[<a 
href="#Xtf">32</a>]</span>. This is an open source
framework for machine learning created by Google for numerical computation
using data flow graphs. Nodes in the graph represent mathematical operations,
while the graph edges represent the multidimensional data arrays called
tensors.
<!--l. 342--><p class="indent" >  The main components in a TensorFlow system are the client, which uses the
Session interface to communicate with the master, and one or more worker
processes, with each worker process responsible for arbitrating access to
one or more computational devices (such as CPU cores or GPU cards)
and for executing graph nodes on those devices as instructed by the
master.
<!--l. 344--><p class="indent" >  TensorFlow offers some powerful features such as: it allows computation
mapping to multiple machines, unlike most other similar frameworks; it has
built in support for automatic gradient computation; it can partially execute
subgraphs of the entire graph and it can add constraints to devices, like placing
nodes on devices of a certain type, ensure that two or more objects are placed in
the same space etc.
<!--l. 346--><p class="indent" >  TensorFlow is used in several projects, such as the Inception Image
Classification Model <span class="cite">[<a 
href="#Xinception">31</a>]</span>. This project introduced a state of the art network for
classification and detection in the ImageNet Large-Scale Visual Recognition
Challenge 2014. In this project the usage of the computing resources is improved
by adjusting the network width and depth while keeping the computational
budget constant<span class="cite">[<a 
href="#Xinception">31</a>]</span>.
<!--l. 348--><p class="indent" >  Another project that employs the TensorFlow framework is DeepSpeech,
developed by Mozilla. It is an open source Speech-To-Text engine based on
Baidu&#8217;s Deep Speech architecture <span class="cite">[<a 
href="#Xdeep_speech">9</a>]</span>. The architecture is a state of the art
recognition system developed using end-to-end deep learning. It is simpler that
other architectures and does not need hand designed components for
background noise, reverberation or speaker variation.
<!--l. 350--><p class="indent" >  We will present the most important utilized methods and data types from
TensorFlow together with a short description for each of them.
                                                                    

                                                                    
<!--l. 353--><p class="indent" >  A convolutional layer is defined like this:
  <!--l. 355-->
<div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-13001r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13002r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">input</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13003r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">filter</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13004r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">strides</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13005r5"></a><span 
class="pxr-x-x-60">5</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">padding</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13006r6"></a><span 
class="pxr-x-x-60">6</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">use_cudnn_on_gpu</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">True</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13007r7"></a><span 
class="pxr-x-x-60">7</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">data_format</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">NHWC</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13008r8"></a><span 
class="pxr-x-x-60">8</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dilations</span><span 
class="txtt-x-x-109">=[1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1],</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13009r9"></a><span 
class="pxr-x-x-60">9</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">None</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13010r10"></a><span 
class="pxr-x-x-60">10</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">)</span>
  </div>
<!--l. 368--><p class="indent" >  Computes a 2-D convolution given 4-D <span 
class="pxi-x-x-109">input </span>and <span 
class="pxi-x-x-109">filter </span>tensors. Given an input
tensor of shape [<span 
class="pxi-x-x-109">batch, in</span><span 
class="pxi-x-x-109">_height, in</span><span 
class="pxi-x-x-109">_width, in</span><span 
class="pxi-x-x-109">_channels</span>] and a kernel tensor of
shape [<span 
class="pxi-x-x-109">filter</span><span 
class="pxi-x-x-109">_height, filter</span><span 
class="pxi-x-x-109">_width, in</span><span 
class="pxi-x-x-109">_channels, out</span><span 
class="pxi-x-x-109">_channels</span>], this op performs the
following:
     <ul class="itemize1">
     <li class="itemize">Flattens the filter to a 2-D matrix with shape [<span 
class="pxi-x-x-109">filter</span><span 
class="pxi-x-x-109">_height * filter</span><span 
class="pxi-x-x-109">_width</span>
     <span 
class="pxi-x-x-109">* in</span><span 
class="pxi-x-x-109">_channels, output</span><span 
class="pxi-x-x-109">_channels</span>].
     </li>
     <li class="itemize">Extracts  image  patches  from  the  input  tensor  to  form  a  virtual
     tensor of shape [<span 
class="pxi-x-x-109">batch, out</span><span 
class="pxi-x-x-109">_height, out</span><span 
class="pxi-x-x-109">_width, filter</span><span 
class="pxi-x-x-109">_height * filter</span><span 
class="pxi-x-x-109">_width</span>
     <span 
class="pxi-x-x-109">* in</span><span 
class="pxi-x-x-109">_channels</span>].
     </li>
     <li class="itemize">For each patch, right-multiplies the filter matrix and the image patch
     vector.</li></ul>
  <!--l. 377-->
<div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-13011r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">max_pool</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13012r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13013r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">ksize</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13014r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">strides</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13015r5"></a><span 
class="pxr-x-x-60">5</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">padding</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13016r6"></a><span 
class="pxr-x-x-60">6</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">data_format</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">NHWC</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13017r7"></a><span 
class="pxr-x-x-60">7</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">None</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13018r8"></a><span 
class="pxr-x-x-60">8</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">)</span>
  </div>
<!--l. 388--><p class="indent" >  Performs the max pooling operation on the input. The <span 
class="pxi-x-x-109">ksize </span>and <span 
class="pxi-x-x-109">strides</span>
parameters can be tuples or lists of tuples of 4 elements. <span 
class="pxi-x-x-109">Ksize </span>represents the size
of the window for each dimension of the input tensor and <span 
class="pxi-x-x-109">strides </span>represents the
stride of the sliding window for each dimension of the input tensor. The <span 
class="pxi-x-x-109">padding</span>
parameter can be &#8216;&#8217;VALID&#8217;&#8216; or &#8216;&#8217;SAME&#8217;&#8216;.
  <!--l. 390-->
<div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-13019r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">relu</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13020r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">features</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13021r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">None</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13022r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">)</span>
  </div>
                                                                    

                                                                    
<!--l. 397--><p class="indent" >  Computes the rectified linear operation - max(features, 0). <span 
class="pxi-x-x-109">Features </span>is a
tensor.
  <!--l. 399-->
<div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-13023r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">dropout</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13024r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13025r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13026r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">noise_shape</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">None</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13027r5"></a><span 
class="pxr-x-x-60">5</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">seed</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">None</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13028r6"></a><span 
class="pxr-x-x-60">6</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">None</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-13029r7"></a><span 
class="pxr-x-x-60">7</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">)</span>
  </div>
<!--l. 409--><p class="indent" >  Applies dropout on input <span 
class="pxi-x-x-109">x </span>with probability <span 
class="pxi-x-x-109">keep</span><span 
class="pxi-x-x-109">_prob</span>. This means that for
each value in <span 
class="pxi-x-x-109">x </span>the method outputs the value scaled by 1 / <span 
class="pxi-x-x-109">keep</span><span 
class="pxi-x-x-109">_prob </span>with
probability <span 
class="pxi-x-x-109">keep</span><span 
class="pxi-x-x-109">_prob </span>or 0. The scaling is done on order to preserve the sum of the
elements. The <span 
class="pxi-x-x-109">noise</span><span 
class="pxi-x-x-109">_shape </span>parameter defines which groups of values are kept or
dropped together. For example, a value of [<span 
class="pxi-x-x-109">k, 1, 1, n</span>] for the <span 
class="pxi-x-x-109">noise</span><span 
class="pxi-x-x-109">_shape</span>, with <span 
class="pxi-x-x-109">x</span>
having the shape [<span 
class="pxi-x-x-109">k, l, m, n</span>], means that each row and column will be kept or
dropped together, while the batch and channel components will be kept or
dropped separately.
<!--l. 411--><p class="nopar" >
  <h3 class="sectionHead"><span class="titlemark">6    </span> <a 
 id="x1-140006"></a>The structure of the neural network used in experiments</h3>
<!--l. 413--><p class="nopar" >For this project we used a convolutional neural network. As previously
described this type of network makes use of convolutional layers, pooling
layers, ReLU layers, fully connected layers and loss layers. In a typical CNN
architecture, each convolutional layer is followed by a Rectified Linear Unit
(ReLU) layer, then a Pooling layer then one or more convolutional layer and
finally one or more fully connected layer.
<!--l. 415--><p class="indent" >  Note again that a characteristic that sets apart the CNN from a regular
neural network is taking into account the structure of the images while
processing them. A regular neural network converts the input in a one
dimensional array which makes the trained classifier less sensitive to positional
changes.
<!--l. 417--><p class="indent" >  The input that we used consists of standard RGB images of size 100 x 100
pixels.
<!--l. 419--><p class="indent" >  The neural network that we used in this project has the structure given in
Table <a 
href="#x1-14001r2">2<!--tex4ht:ref: tab_settings --></a>.
<a 
 id="x1-14001r2"></a>
  <!--l. 422--><div class="longtable"> <table id="TBL-2" class="longtable" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1"></colgroup><colgroup id="TBL-2-2g"><col 
id="TBL-2-2"></colgroup><colgroup id="TBL-2-3g"><col 
id="TBL-2-3"></colgroup>
                                                                    

                                                                    
<tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td colspan="3" style="white-space:nowrap; text-align:left;" id="TBL-2-1-1"  
class="td11"> <div class="multicolumn"  style="white-space:nowrap; text-align:center;"> <div class="caption" 
><span class="id">Table&#x00A0;2: </span><span  
class="content">The structure of the neural network used in this
paper.</span></div><!--tex4ht:label?: x1-14001r2 -->                                                                                               </div>  <a 
 id="x1-14002"></a>
</td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-2-2-1"  
class="td11"> <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><span 
class="pxb-x-x-109">Layer type</span></div> </td><td  style="white-space:nowrap; text-align:center;" id="TBL-2-2-2"  
class="td11"> <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><span 
class="pxb-x-x-109">Dimensions</span></div> </td><td  style="white-space:nowrap; text-align:center;" id="TBL-2-2-3"  
class="td11">          <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><span 
class="pxb-x-x-109">Output</span></div>
</td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-1"  
class="td11">           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-1"  
class="td11">            </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-2"  
class="td11">              </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-3"  
class="td11"></td></tr>
<tr  
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-1"  
class="td11"> Convolutional     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-2"  
class="td11"> 5 x 5 x 4                 </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-3"  
class="td11"> 16      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-8-1"  
class="td11"> Max pooling        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-8-2"  
class="td11"> 2 x 2 &#8212; Stride: 2  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-8-3"  
class="td11"> -         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-9-1"  
class="td11"> Convolutional     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-9-2"  
class="td11"> 5 x 5 x 16               </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-9-3"  
class="td11"> 32      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-10-1"  
class="td11"> Max pooling        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-10-2"  
class="td11"> 2 x 2 &#8212; Stride: 2  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-10-3"  
class="td11"> -         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-11-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-11-1"  
class="td11"> Convolutional     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-11-2"  
class="td11"> 5 x 5 x 32               </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-11-3"  
class="td11"> 64      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-12-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-12-1"  
class="td11"> Max pooling        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-12-2"  
class="td11"> 2 x 2 &#8212; Stride: 2  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-12-3"  
class="td11"> -         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-13-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-13-1"  
class="td11"> Convolutional     </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-13-2"  
class="td11"> 5 x 5 x 64               </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-13-3"  
class="td11"> 128    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-14-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-14-1"  
class="td11"> Max pooling        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-14-2"  
class="td11"> 2 x 2 &#8212; Stride: 2  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-14-3"  
class="td11"> -         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-15-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-15-1"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-15-2"  
class="td11"> 5 x 5 x 128             </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-15-3"  
class="td11"> 1024  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-16-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-16-1"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-16-2"  
class="td11"> 1024                       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-16-3"  
class="td11"> 256    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-17-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-17-1"  
class="td11"> Softmax                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-17-2"  
class="td11"> 256                         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-17-3"  
class="td11"> 60      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-18-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-18-1"  
class="td11">               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-19-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-19-1"  
class="td11">               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-20-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-20-1"  
class="td11">               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-21-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-21-1"  
class="td11">               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-22-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-22-1"  
class="td11">               </td></tr>
  </table></div>
                                                                    

                                                                    
<!--l. 443--><p class="indent" >  <a 
 id="x1-14003r2"></a><hr class="float"><div class="float" 
>
                                                                    

                                                                    
<!--l. 445--><p class="noindent" ><img 
src="Resources/network.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;2: </span><span  
class="content">Graphical representation of the convolutional neural network
used in experiments.</span></div><!--tex4ht:label?: x1-14003r2 -->
                                                                    

                                                                    
  </div><hr class="endfloat" />
<!--l. 450--><p class="indent" >  A visual representation of the neural network used is given in Figure
<a 
href="#x1-14003r2">2<!--tex4ht:ref: network_structure --></a>.
     <ul class="itemize1">
     <li class="itemize">The first layer (Convolution #1) is a convolutional layer which applies
     16 5 x 5 filters. On this layer we apply max pooling with a filter of
     shape 2 x 2 with stride 2 which specifies that the pooled regions do
     not overlap (Max-Pool #1). This also reduces the width and height to
     50 pixels each.
     </li>
     <li class="itemize">The  second  convolutional  (Convolution  #2)  layer  applies  32  5  x  5
     filters which outputs 32 activation maps. We apply on this layer the
     same kind of max pooling(Max-Pool #2) as on the first layer, shape 2
     x 2 and stride 2.
     </li>
     <li class="itemize">The third convolutional (Convolution #3) layer applies 64 5 x 5 filters.
     Following is another max pool layer(Max-Pool #3) of shape 2 x 2 and
     stride 2.
     </li>
     <li class="itemize">The  fourth  convolutional  (Convolution  #4)  layer  applies  128  5  x  5
     filters after which we apply a final max pool layer (Max-Pool #4).
     </li>
     <li class="itemize">Because  of  the  four  max  pooling  layers,  the  dimensions  of  the
     representation have each been reduced by a factor of 16, therefore the
     fifth layer, which is a fully connected layer(Fully Connected #1), has
     7 x 7 x 16 inputs.
     </li>
     <li class="itemize">This layer feeds into another fully connected layer (Fully Connected
     #2) with 1024 inputs and 256 outputs.
     </li>
     <li class="itemize">The last layer is a softmax loss layer (Softmax) with 256 inputs. The
     number of outputs is equal to the number of classes.</li></ul>
<!--l. 461--><p class="indent" >  We present a short scheme containing the flow of the the training
process:
                                                                    

                                                                    
  <!--l. 463-->
<div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-14004r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">iterations</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">75000</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14005r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14006r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">read_images</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14007r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">apply_random_hue_saturation_changes</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14008r5"></a><span 
class="pxr-x-x-60">5</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">apply_random_vertical_horizontal_flips</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14009r6"></a><span 
class="pxr-x-x-60">6</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">convert_to_hsv</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14010r7"></a><span 
class="pxr-x-x-60">7</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">add_grayscale_layer</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14011r8"></a><span 
class="pxr-x-x-60">8</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14012r9"></a><span 
class="pxr-x-x-60">9</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">define_network_structure</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14013r10"></a><span 
class="pxr-x-x-60">10</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">training_operation</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14014r11"></a><span 
class="pxr-x-x-60">11</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14015r12"></a><span 
class="pxr-x-x-60">12</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">i</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">range</span><span 
class="txtt-x-x-109">(1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">iterations</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-14016r13"></a><span 
class="pxr-x-x-60">13</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">training_operation</span><span 
class="txtt-x-x-109">)</span>
  </div>
  <h3 class="sectionHead"><span class="titlemark">7    </span> <a 
 id="x1-150007"></a>Numerical experiments</h3>
<!--l. 482--><p class="nopar" >The dataset was split in 2 parts: training set - which consists of 46371 images of
fruits and testing set - which is made of 15563 images.
<!--l. 484--><p class="indent" >  The data was bundled into a TFRecords file (specific to TensorFlow). This is a
binary file that contains protocol buffers with a feature map. In this map it is
possible to store information such as the image height, width, depth and even
the raw image. Using these files we can create queues in order to feed the data to
the neural network.
<!--l. 487--><p class="indent" >  By calling the method <span 
class="pxmi-x-x-109">shuffle</span>_<span 
class="pxmi-x-x-109">batch </span>we provide randomized input to the
network. The way we used this method was providing it example tensors for
images and labels and it returned tensors of shape batch size x image
dimensions and batch size x labels. This helps greatly lower the chance of using
the same batch multiple times for training, which in turn improves the quality of
the network.
<!--l. 489--><p class="indent" >  We ran multiple scenarios in which the neural network was trained using
different levels of data augmentation and preprocessing:
     <ul class="itemize1">
     <li class="itemize">convert the input RGB images to grayscale
     </li>
     <li class="itemize">keep the input images in the RGB colorspace
     </li>
     <li class="itemize">convert the input RGB images to the HSV colorspace
     </li>
     <li class="itemize">convert the input RGB images to the HSV colorspace and to grayscale
     and merge them
     </li>
     <li class="itemize">apply random hue and saturation changes on the input RGB images,
     randomly flip them horizontally and vertically, then convert them to
     the HSV colorspace and to grayscale and merge them
                                                                    

                                                                    
     </li></ul>
<!--l. 500--><p class="indent" >  For each scenario we used the previously described neural network which
was trained over 75000 iterations with batches of 60 images selected at random
from the training set. Every 50 steps we calculated the accuracy using
cross-validation. For testing we ran the trained network on the test set. The
results for each case are presented in Table <a 
href="#x1-15001r3">3<!--tex4ht:ref: tab_accuracy --></a>.
<a 
 id="x1-15001r3"></a>
  <!--l. 504--><div class="longtable"> <table id="TBL-3" class="longtable" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1"></colgroup><colgroup id="TBL-3-2g"><col 
id="TBL-3-2"></colgroup><colgroup id="TBL-3-3g"><col 
id="TBL-3-3"></colgroup>
<tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td colspan="3" style="white-space:wrap; text-align:left;" id="TBL-3-1-1"  
class="td11">       <div class="multicolumn"  style="white-space:nowrap; text-align:center;"> <div class="caption" 
><span class="id">Table&#x00A0;3:  </span><span  
class="content">Results  of  training  the  neural  network  on  the
fruits-360 dataset.</span></div><!--tex4ht:label?: x1-15001r3 -->                                                                          </div>              <a 
 id="x1-15002"></a>
</td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-3-2-1"  
class="td11">            <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><span 
class="pxb-x-x-109">Scenario</span></div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-2-2"  
class="td11">
 <!--l. 507--><p class="noindent" ><span 
class="pxb-x-x-109">Accuracy on</span>
  <span 
class="pxb-x-x-109">training set</span>       </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-2-3"  
class="td11">
 <!--l. 507--><p class="noindent" ><span 
class="pxb-x-x-109">Accuracy on</span>
  <span 
class="pxb-x-x-109">test set</span>                </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-3-1"  
class="td11">
 <!--l. 508--><p class="noindent" >                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-4-1"  
class="td11">                                   </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-4-2"  
class="td11">                </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-4-3"  
class="td11"></td></tr>
<tr  
 style="vertical-align:baseline;" id="TBL-3-7-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-7-1"  
class="td11">
 <!--l. 511--><p class="noindent" >Grayscale                                               </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-7-2"  
class="td11">
 <!--l. 511--><p class="noindent" >99.96%                </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-7-3"  
class="td11">
 <!--l. 511--><p class="noindent" >94.24%                </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-8-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-8-1"  
class="td11">
 <!--l. 512--><p class="noindent" >RGB                                                        </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-8-2"  
class="td11">
 <!--l. 512--><p class="noindent" >99.23%                </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-8-3"  
class="td11">
 <!--l. 512--><p class="noindent" >93.47%                </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-9-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-9-1"  
class="td11">
 <!--l. 513--><p class="noindent" >HSV                                                        </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-9-2"  
class="td11">
 <!--l. 513--><p class="noindent" >99.98%                </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-9-3"  
class="td11">
 <!--l. 513--><p class="noindent" >97.01%                </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-10-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-10-1"  
class="td11">
 <!--l. 514--><p class="noindent" >HSV + Grayscale                                  </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-10-2"  
class="td11">
 <!--l. 514--><p class="noindent" >99.78%                </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-10-3"  
class="td11">
 <!--l. 514--><p class="noindent" >95.71%                </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-11-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-11-1"  
class="td11">
 <!--l. 515--><p class="noindent" >HSV + Grayscale + hue/saturation
  change + flips                                        </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-11-2"  
class="td11">
 <!--l. 515--><p class="noindent" >99.86%                </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-11-3"  
class="td11">
 <!--l. 515--><p class="noindent" >97.04%                </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-12-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-12-1"  
class="td11">                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-13-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-13-1"  
class="td11">                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-14-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-14-1"  
class="td11">
 <!--l. 517--><p class="noindent" >                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-15-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-15-1"  
class="td11">
 <!--l. 517--><p class="noindent" >                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-16-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-16-1"  
class="td11">
 <!--l. 517--><p class="noindent" >                               </td>
  </tr>
  </table></div>
<!--l. 519--><p class="indent" >  As reflected in Table <a 
href="#x1-15001r3">3<!--tex4ht:ref: tab_accuracy --></a> the best results were obtained by applying data
augmentation and converting the RGB images to the HSV colorspace to
                                                                    

                                                                    
which the grayscale representation was added. This is intuitive since in
this scenario we attach the most amount of information to the input,
thus the network can learn multiple features in order to classify the
images.
<!--l. 521--><p class="indent" >  It is also important to notice that training the grayscale images only
yielded the best results on the train set but very weak results on the test
set. We investigated this problem and we have discovered that a lot of
images containing apples are incorrectly classified on the test set. In
order to further investigate the issue we ran a round of training and
testing on just the apple classes of images. The results were similar,
with high accuracy on the train data, but low accuracy on the test data.
We attribute this to overfitting, because the grayscale images lose too
many features, the network does not learn properly how to classify the
images.
<!--l. 523--><p class="indent" >  In order to determine the best network configuration for classifying the
images in out dataset, we took multiple configurations, used the train set to train
them and then calculated their accuracy on the test and training set. In Table <a 
href="#x1-15003r4">4<!--tex4ht:ref: tab_configuration_comparison --></a>
we present the results.
<a 
 id="x1-15003r4"></a>
  <!--l. 526--><div class="longtable"> <table id="TBL-4" class="longtable" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-4-1g"><col 
id="TBL-4-1"></colgroup><colgroup id="TBL-4-2g"><col 
id="TBL-4-2"></colgroup><colgroup id="TBL-4-3g"><col 
id="TBL-4-3"></colgroup><colgroup id="TBL-4-4g"><col 
id="TBL-4-4"></colgroup><colgroup id="TBL-4-5g"><col 
id="TBL-4-5"></colgroup><colgroup id="TBL-4-6g"><col 
id="TBL-4-6"></colgroup>
<tr  
 style="vertical-align:baseline;" id="TBL-4-1-"><td colspan="3" style="white-space:nowrap; text-align:center;" id="TBL-4-1-1"  
class="td11"></td> <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><div class="caption" 
><span class="id">Table&#x00A0;4: </span><span  
class="content">Results of training different network configurations
on the fruits-360 dataset.</span></div><!--tex4ht:label?: x1-15003r4 -->                                                              </div>  <a 
 id="x1-15004"></a>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-2-1"  
class="td11"> <span 
class="pxb-x-x-109">Nr.  </span></td><td colspan="3" style="white-space:nowrap; text-align:center;" id="TBL-4-2-2"  
class="td11"> <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><span 
class="pxb-x-x-109">Configuration</span></div> </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-2-5"  
class="td11">
 <!--l. 528--><p class="noindent" ><span 
class="pxb-x-x-109">Accuracy on</span>
  <span 
class="pxb-x-x-109">training set</span>    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-2-6"  
class="td11">
 <!--l. 528--><p class="noindent" ><span 
class="pxb-x-x-109">Accuracy</span>
  <span 
class="pxb-x-x-109">on test set</span>           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-3-1"  
class="td11">     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-4-1"  
class="td11">     </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-4-2"  
class="td11"></td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-4-3"  
class="td11"></td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-4-4"  
class="td11">           </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-4-5"  
class="td11">              </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-4-6"  
class="td11"></td></tr>
<tr  
 style="vertical-align:baseline;" id="TBL-4-5-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-5-1"  
class="td11">  <div class="multirow"><!-- rows=256 -->
1</div>  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-5-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-5-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-5-4"  
class="td11">  16    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-5-5"  
class="td11">
 <!--l. 533--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
99.86%</div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-5-6"  
class="td11">
 <!--l. 533--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
97.04%</div>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-6-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-6-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-7-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-7-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-7-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-7-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-7-4"  
class="td11">  32    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-7-5"  
class="td11">
 <!--l. 534--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-7-6"  
class="td11">
 <!--l. 534--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-8-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-8-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-9-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-9-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-9-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-9-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-9-4"  
class="td11">  64    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-9-5"  
class="td11">
 <!--l. 535--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-9-6"  
class="td11">
 <!--l. 535--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-10-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-10-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-11-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-11-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-11-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-11-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-11-4"  
class="td11">  128   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-11-5"  
class="td11">
 <!--l. 536--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-11-6"  
class="td11">
 <!--l. 536--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-12-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-12-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-13-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-13-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-13-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-13-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-13-4"  
class="td11"> 1024  </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-13-5"  
class="td11">
 <!--l. 537--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-13-6"  
class="td11">
 <!--l. 537--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-14-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-14-1"  
class="td11">
                                                                    

                                                                    
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-15-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-15-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-15-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-15-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-15-4"  
class="td11">  256   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-15-5"  
class="td11">
 <!--l. 538--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-15-6"  
class="td11">
 <!--l. 538--><p class="noindent" >           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-16-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-16-1"  
class="td11"> <div class="multirow"><!-- rows=256 -->
2</div>   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-16-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-16-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-16-4"  
class="td11">  8     </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-16-5"  
class="td11">
 <!--l. 540--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
99.78%</div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-16-6"  
class="td11">
 <!--l. 540--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
95.84%</div>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-17-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-17-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-18-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-18-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-18-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-18-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-18-4"  
class="td11">  32    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-18-5"  
class="td11">
 <!--l. 541--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-18-6"  
class="td11">
 <!--l. 541--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-19-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-19-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-20-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-20-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-20-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-20-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-20-4"  
class="td11">  64    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-20-5"  
class="td11">
 <!--l. 542--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-20-6"  
class="td11">
 <!--l. 542--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-21-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-21-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-22-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-22-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-22-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-22-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-22-4"  
class="td11">  128   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-22-5"  
class="td11">
 <!--l. 543--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-22-6"  
class="td11">
 <!--l. 543--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-23-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-23-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-24-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-24-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-24-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-24-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-24-4"  
class="td11"> 1024  </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-24-5"  
class="td11">
 <!--l. 544--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-24-6"  
class="td11">
 <!--l. 544--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-25-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-25-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-26-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-26-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-26-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-26-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-26-4"  
class="td11">  256   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-26-5"  
class="td11">
 <!--l. 545--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-26-6"  
class="td11">
 <!--l. 545--><p class="noindent" >           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-27-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-27-1"  
class="td11"> <div class="multirow"><!-- rows=256 -->
3</div>   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-27-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-27-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-27-4"  
class="td11">  32    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-27-5"  
class="td11">
 <!--l. 547--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
99.95%</div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-27-6"  
class="td11">
 <!--l. 547--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
95.43%</div>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-28-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-28-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-29-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-29-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-29-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-29-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-29-4"  
class="td11">  32    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-29-5"  
class="td11">
 <!--l. 548--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-29-6"  
class="td11">
 <!--l. 548--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-30-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-30-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-31-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-31-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-31-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-31-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-31-4"  
class="td11">  64    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-31-5"  
class="td11">
 <!--l. 549--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-31-6"  
class="td11">
 <!--l. 549--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-32-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-32-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-33-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-33-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-33-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-33-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-33-4"  
class="td11">  128   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-33-5"  
class="td11">
 <!--l. 550--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-33-6"  
class="td11">
 <!--l. 550--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-34-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-34-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-35-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-35-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-35-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-35-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-35-4"  
class="td11"> 1024  </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-35-5"  
class="td11">
 <!--l. 551--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-35-6"  
class="td11">
 <!--l. 551--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-36-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-36-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-37-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-37-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-37-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-37-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-37-4"  
class="td11">  256   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-37-5"  
class="td11">
 <!--l. 552--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-37-6"  
class="td11">
 <!--l. 552--><p class="noindent" >           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-38-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-38-1"  
class="td11"> <div class="multirow"><!-- rows=256 -->
4</div>   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-38-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-38-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-38-4"  
class="td11">  16    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-38-5"  
class="td11">
 <!--l. 555--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
99.86%</div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-38-6"  
class="td11">
 <!--l. 555--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
96.37%</div>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-39-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-39-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-40-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-40-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-40-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-40-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-40-4"  
class="td11">  16    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-40-5"  
class="td11">
 <!--l. 556--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-40-6"  
class="td11">
 <!--l. 556--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-41-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-41-1"  
class="td11">    </td></tr>
<tr  
 style="vertical-align:baseline;" id="TBL-4-42-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-42-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-43-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-43-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-43-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-43-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-43-4"  
class="td11">  64    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-43-5"  
class="td11">
 <!--l. 557--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-43-6"  
class="td11">
 <!--l. 557--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-44-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-44-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-45-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-45-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-45-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-45-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-45-4"  
class="td11">  128   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-45-5"  
class="td11">
 <!--l. 558--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-45-6"  
class="td11">
 <!--l. 558--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-46-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-46-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-47-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-47-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-47-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-47-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-47-4"  
class="td11"> 1024  </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-47-5"  
class="td11">
 <!--l. 559--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-47-6"  
class="td11">
 <!--l. 559--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-48-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-48-1"  
class="td11">
                                                                    

                                                                    
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-49-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-49-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-49-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-49-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-49-4"  
class="td11">  256   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-49-5"  
class="td11">
 <!--l. 560--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-49-6"  
class="td11">
 <!--l. 560--><p class="noindent" >           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-50-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-50-1"  
class="td11"> <div class="multirow"><!-- rows=256 -->
5</div>  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-50-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-50-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-50-4"  
class="td11">  16    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-50-5"  
class="td11">
 <!--l. 562--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
99.95%</div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-50-6"  
class="td11">
 <!--l. 562--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
96.60%</div>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-51-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-51-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-52-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-52-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-52-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-52-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-52-4"  
class="td11">  64    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-52-5"  
class="td11">
 <!--l. 563--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-52-6"  
class="td11">
 <!--l. 563--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-53-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-53-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-54-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-54-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-54-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-54-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-54-4"  
class="td11">  64    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-54-5"  
class="td11">
 <!--l. 564--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-54-6"  
class="td11">
 <!--l. 564--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-55-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-55-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-56-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-56-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-56-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-56-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-56-4"  
class="td11">  128   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-56-5"  
class="td11">
 <!--l. 565--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-56-6"  
class="td11">
 <!--l. 565--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-57-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-57-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-58-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-58-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-58-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-58-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-58-4"  
class="td11"> 1024  </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-58-5"  
class="td11">
 <!--l. 566--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-58-6"  
class="td11">
 <!--l. 566--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-59-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-59-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-60-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-60-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-60-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-60-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-60-4"  
class="td11">  256   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-60-5"  
class="td11">
 <!--l. 567--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-60-6"  
class="td11">
 <!--l. 567--><p class="noindent" >           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-61-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-61-1"  
class="td11"> <div class="multirow"><!-- rows=256 -->
6</div>  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-61-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-61-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-61-4"  
class="td11">  16    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-61-5"  
class="td11">
 <!--l. 569--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
99.88%</div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-61-6"  
class="td11">
 <!--l. 569--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
96.19%</div>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-62-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-62-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-63-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-63-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-63-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-63-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-63-4"  
class="td11">  32    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-63-5"  
class="td11">
 <!--l. 570--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-63-6"  
class="td11">
 <!--l. 570--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-64-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-64-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-65-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-65-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-65-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-65-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-65-4"  
class="td11">  32    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-65-5"  
class="td11">
 <!--l. 571--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-65-6"  
class="td11">
 <!--l. 571--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-66-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-66-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-67-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-67-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-67-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-67-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-67-4"  
class="td11">  128   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-67-5"  
class="td11">
 <!--l. 572--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-67-6"  
class="td11">
 <!--l. 572--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-68-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-68-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-69-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-69-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-69-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-69-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-69-4"  
class="td11"> 1024  </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-69-5"  
class="td11">
 <!--l. 573--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-69-6"  
class="td11">
 <!--l. 573--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-70-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-70-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-71-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-71-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-71-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-71-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-71-4"  
class="td11">  256   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-71-5"  
class="td11">
 <!--l. 574--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-71-6"  
class="td11">
 <!--l. 574--><p class="noindent" >           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-72-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-72-1"  
class="td11"> <div class="multirow"><!-- rows=256 -->
7</div>  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-72-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-72-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-72-4"  
class="td11">  16    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-72-5"  
class="td11">
 <!--l. 576--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
99.84%</div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-72-6"  
class="td11">
 <!--l. 576--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
95.50%</div>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-73-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-73-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-74-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-74-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-74-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-74-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-74-4"  
class="td11">  32    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-74-5"  
class="td11">
 <!--l. 577--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-74-6"  
class="td11">
 <!--l. 577--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-75-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-75-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-76-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-76-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-76-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-76-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-76-4"  
class="td11">  128   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-76-5"  
class="td11">
 <!--l. 578--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-76-6"  
class="td11">
 <!--l. 578--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-77-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-77-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-78-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-78-1"  
class="td11">   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-78-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-78-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-78-4"  
class="td11">  128   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-78-5"  
class="td11">
 <!--l. 579--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-78-6"  
class="td11">
 <!--l. 579--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-79-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-79-1"  
class="td11">   </td></tr>
<tr  
 style="vertical-align:baseline;" id="TBL-4-80-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-80-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-81-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-81-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-81-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-81-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-81-4"  
class="td11"> 1024  </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-81-5"  
class="td11">
 <!--l. 580--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-81-6"  
class="td11">
 <!--l. 580--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-82-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-82-1"  
class="td11">
                                                                    

                                                                    
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-83-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-83-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-83-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-83-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-83-4"  
class="td11">  256   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-83-5"  
class="td11">
 <!--l. 581--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-83-6"  
class="td11">
 <!--l. 581--><p class="noindent" >           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-84-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-84-1"  
class="td11">  <div class="multirow"><!-- rows=256 -->
8</div>   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-84-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-84-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-84-4"  
class="td11">  16    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-84-5"  
class="td11">
 <!--l. 583--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
99.24%</div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-84-6"  
class="td11">
 <!--l. 583--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
94.53%</div>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-85-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-85-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-86-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-86-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-86-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-86-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-86-4"  
class="td11">  32    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-86-5"  
class="td11">
 <!--l. 584--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-86-6"  
class="td11">
 <!--l. 584--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-87-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-87-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-88-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-88-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-88-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-88-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-88-4"  
class="td11">  64    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-88-5"  
class="td11">
 <!--l. 585--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-88-6"  
class="td11">
 <!--l. 585--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-89-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-89-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-90-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-90-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-90-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-90-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-90-4"  
class="td11">  64    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-90-5"  
class="td11">
 <!--l. 586--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-90-6"  
class="td11">
 <!--l. 586--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-91-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-91-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-92-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-92-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-92-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-92-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-92-4"  
class="td11"> 1024  </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-92-5"  
class="td11">
 <!--l. 587--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-92-6"  
class="td11">
 <!--l. 587--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-93-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-93-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-94-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-94-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-94-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-94-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-94-4"  
class="td11">  256   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-94-5"  
class="td11">
 <!--l. 588--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-94-6"  
class="td11">
 <!--l. 588--><p class="noindent" >           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-95-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-95-1"  
class="td11">  <div class="multirow"><!-- rows=256 -->
9</div>   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-95-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-95-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-95-4"  
class="td11">  16    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-95-5"  
class="td11">
 <!--l. 591--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
99.93%</div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-95-6"  
class="td11">
 <!--l. 591--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
97.00%</div>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-96-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-96-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-97-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-97-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-97-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-97-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-97-4"  
class="td11">  32    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-97-5"  
class="td11">
 <!--l. 592--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-97-6"  
class="td11">
 <!--l. 592--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-98-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-98-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-99-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-99-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-99-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-99-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-99-4"  
class="td11">  64    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-99-5"  
class="td11">
 <!--l. 593--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-99-6"  
class="td11">
 <!--l. 593--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-100-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-100-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-101-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-101-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-101-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-101-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-101-4"  
class="td11">  128   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-101-5"  
class="td11">
 <!--l. 594--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-101-6"  
class="td11">
 <!--l. 594--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-102-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-102-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-103-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-103-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-103-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-103-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-103-4"  
class="td11">  512   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-103-5"  
class="td11">
 <!--l. 595--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-103-6"  
class="td11">
 <!--l. 595--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-104-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-104-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-105-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-105-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-105-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-105-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-105-4"  
class="td11">  256   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-105-5"  
class="td11">
 <!--l. 596--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-105-6"  
class="td11">
 <!--l. 596--><p class="noindent" >           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-106-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-106-1"  
class="td11"> <div class="multirow"><!-- rows=256 -->
10</div>  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-106-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-106-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-106-4"  
class="td11">  16    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-106-5"  
class="td11">
 <!--l. 598--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
99.82%</div>             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-106-6"  
class="td11">
 <!--l. 598--><p class="noindent" ><div class="multirow"><!-- rows=256 -->
96.37%</div>           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-107-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-107-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-108-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-108-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-108-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-108-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-108-4"  
class="td11">  32    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-108-5"  
class="td11">
 <!--l. 599--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-108-6"  
class="td11">
 <!--l. 599--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-109-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-109-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-110-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-110-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-110-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-110-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-110-4"  
class="td11">  64    </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-110-5"  
class="td11">
 <!--l. 600--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-110-6"  
class="td11">
 <!--l. 600--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-111-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-111-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-112-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-112-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-112-2"  
class="td11">  Convolutional    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-112-3"  
class="td11"> 5 x 5  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-112-4"  
class="td11">  128   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-112-5"  
class="td11">
 <!--l. 601--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-112-6"  
class="td11">
 <!--l. 601--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-113-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-113-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-114-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-114-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-114-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-114-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-114-4"  
class="td11"> 1024  </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-114-5"  
class="td11">
 <!--l. 602--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-114-6"  
class="td11">
 <!--l. 602--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-115-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-115-1"  
class="td11">
</td></tr><tr 
class="cline"><td></td><td><hr></td><td><hr></td><td><hr></td><td></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-116-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-116-1"  
class="td11">    </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-116-2"  
class="td11"> Fully connected  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-116-3"  
class="td11">   -      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-4-116-4"  
class="td11">  512   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-116-5"  
class="td11">
 <!--l. 603--><p class="noindent" >            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-116-6"  
class="td11">
 <!--l. 603--><p class="noindent" >           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-117-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-117-1"  
class="td11">    </td>
                                                                    

                                                                    
  </tr>
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-118-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-118-1"  
class="td11">  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-119-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-119-1"  
class="td11">  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-120-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-120-1"  
class="td11">  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-121-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-121-1"  
class="td11">  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-122-"><td  style="white-space:nowrap; text-align:center;" id="TBL-4-122-1"  
class="td11">  </td></tr>
  </table></div>
<!--l. 607--><p class="indent" >  From Table <a 
href="#x1-15003r4">4<!--tex4ht:ref: tab_configuration_comparison --></a> we can see that the best performance on the test set was obtained
by configuration nr. 1, however, this configuration did not obtain the best
accuracy on the training set. Configurations 5 and 3 obtained the best accuracy
on the train set (99.95%), but the performance on the test set lagged behind a bit.
For configuration 3 this phenomenon is much more pronounced, as the
difference between train and test accuracies is 4.52%. Similarly, configuration 8
has a big difference in performance between the train and test sets. This is a
result of the model overfitting to the training data and not properly generalizing
to other images. The second best performance on the train set was obtained by
configuration 9, which also obtained the second best accuracy on the test
set.
<!--l. 609--><p class="indent" >
                                                                    

                                                                    
<!--l. 611--><p class="indent" >  The evolution of accuracy during training is given in Figure <a 
href="#x1-15005r3">3<!--tex4ht:ref: accuracy_evolution --></a>. It can be seen
that the training rapidly improves in the first 1000 iterations (accuracy becomes
greater than 90%) and then it is very slowly improved in the next 74000
iterations.
                                                                    

                                                                    
<!--l. 613--><p class="indent" >  <a 
 id="x1-15005r3"></a><hr class="float"><div class="float" 
>
                                                                    

                                                                    
<!--l. 615--><p class="noindent" ><img 
src="Resources/accuracy.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;3: </span><span  
class="content">Accuracy evolution over 75000 training iterations</span></div><!--tex4ht:label?: x1-15005r3 -->
                                                                    

                                                                    
  </div><hr class="endfloat" />
<!--l. 620--><p class="indent" >  Some of the incorrectly classified images are given in Table <a 
href="#x1-15006r5">5<!--tex4ht:ref: tab_results --></a>.
<a 
 id="x1-15006r5"></a>
  <!--l. 623--><div class="longtable"> <table id="TBL-5" class="longtable" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-5-1g"><col 
id="TBL-5-1"></colgroup><colgroup id="TBL-5-2g"><col 
id="TBL-5-2"></colgroup><colgroup id="TBL-5-3g"><col 
id="TBL-5-3"></colgroup><colgroup id="TBL-5-4g"><col 
id="TBL-5-4"></colgroup>
<tr  
 style="vertical-align:baseline;" id="TBL-5-1-"><td colspan="3" style="white-space:wrap; text-align:left;" id="TBL-5-1-1"  
class="td11"></td>           <div class="multicolumn"  style="white-space:nowrap; text-align:center;"><div class="caption" 
><span class="id">Table&#x00A0;5: </span><span  
class="content">Some of the images that were classified incorrectly.
On the top we have the correct class of the fruit and on the
bottom we have the class (and its associated probability) that
was assigned by the network.</span></div><!--tex4ht:label?: x1-15006r5 -->                                                     </div>                        <a 
 id="x1-15007"></a>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-2-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-2-1"  
class="td11">
 <!--l. 627--><p class="noindent" >Apple Golden 2     </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-2-2"  
class="td11">
 <!--l. 627--><p class="noindent" >Apple Golden 3     </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-2-3"  
class="td11">
 <!--l. 627--><p class="noindent" >Braeburn(Apple)   </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-2-4"  
class="td11">
 <!--l. 627--><p class="noindent" >Peach                       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-3-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-3-1"  
class="td11">
 <!--l. 628--><p class="noindent" ><img 
src="Resources/apple_golden_2.jpg" alt="PIC"  
>                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-3-2"  
class="td11">
 <!--l. 629--><p class="noindent" ><img 
src="Resources/apple_golden_3.jpg" alt="PIC"  
>                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-3-3"  
class="td11">
 <!--l. 630--><p class="noindent" ><img 
src="Resources/braeburn.jpg" alt="PIC"  
>                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-3-4"  
class="td11">
 <!--l. 631--><p class="noindent" ><img 
src="Resources/peach_1.jpg" alt="PIC"  
>                           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-4-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-4-1"  
class="td11">
 <!--l. 632--><p class="noindent" >Apple Golden 3     </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-4-2"  
class="td11">
 <!--l. 632--><p class="noindent" >Granny Smith
  (Apple)                    </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-4-3"  
class="td11">
 <!--l. 632--><p class="noindent" >Apple Red 2           </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-4-4"  
class="td11">
 <!--l. 632--><p class="noindent" >Apple Red
  Yellow                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-5-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-5-1"  
class="td11">
 <!--l. 633--><p class="noindent" >96.54%                     </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-5-2"  
class="td11">
 <!--l. 633--><p class="noindent" >95.22%                     </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-5-3"  
class="td11">
 <!--l. 633--><p class="noindent" >97.71%                     </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-5-4"  
class="td11">
 <!--l. 633--><p class="noindent" >97.85%                     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-6-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-6-1"  
class="td11">
 <!--l. 635--><p class="noindent" >Pomegranate          </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-6-2"  
class="td11">
 <!--l. 635--><p class="noindent" >Peach                       </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-6-3"  
class="td11">
 <!--l. 635--><p class="noindent" >Pear                         </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-6-4"  
class="td11">
 <!--l. 635--><p class="noindent" >Pomegranate          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-7-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-7-1"  
class="td11">
 <!--l. 636--><p class="noindent" ><img 
src="Resources/pomegranate_1.jpg" alt="PIC"  
>                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-7-2"  
class="td11">
 <!--l. 637--><p class="noindent" ><img 
src="Resources/peach_2.jpg" alt="PIC"  
>                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-7-3"  
class="td11">
 <!--l. 638--><p class="noindent" ><img 
src="Resources/pear.jpg" alt="PIC"  
>                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-7-4"  
class="td11">
 <!--l. 639--><p class="noindent" ><img 
src="Resources/pomegranate_2.jpg" alt="PIC"  
>                           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-8-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-8-1"  
class="td11">
 <!--l. 640--><p class="noindent" >Nectarine                </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-8-2"  
class="td11">
 <!--l. 640--><p class="noindent" >Apple Red 1           </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-8-3"  
class="td11">
 <!--l. 640--><p class="noindent" >Apple Golden 2     </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-8-4"  
class="td11">
 <!--l. 640--><p class="noindent" >Braeburn(Apple)   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-9-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-9-1"  
class="td11">
 <!--l. 641--><p class="noindent" >94.64%                     </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-9-2"  
class="td11">
 <!--l. 641--><p class="noindent" >97.87%                     </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-9-3"  
class="td11">
 <!--l. 641--><p class="noindent" >98.73%                     </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-9-4"  
class="td11">
 <!--l. 641--><p class="noindent" >97.21%                     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-10-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-10-1"  
class="td11">                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-11-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-11-1"  
class="td11">                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-12-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-12-1"  
class="td11">
 <!--l. 643--><p class="noindent" >                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-13-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-13-1"  
class="td11">
 <!--l. 643--><p class="noindent" >                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-14-"><td  style="white-space:wrap; text-align:left;" id="TBL-5-14-1"  
class="td11">                   </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-14-2"  
class="td11">                   </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-14-3"  
class="td11">                   </td><td  style="white-space:wrap; text-align:left;" id="TBL-5-14-4"  
class="td11"></td></tr>
  </table></div>
  <h3 class="sectionHead"><span class="titlemark">8    </span> <a 
 id="x1-160008"></a>Conclusions and further work</h3>
<!--l. 647--><p class="noindent" >We described a new and complex database of images with fruits. Also we made
some numerical experiments by using TensorFlow library in order to classify the
                                                                    

                                                                    
images according to their content.
<!--l. 649--><p class="indent" >  From our point of view one of the main objectives for the future is to improve
the accuracy of the neural network. This involves further experimenting
with the structure of the network. Various tweaks and changes to any
layers as well as the introduction of new layers can provide completely
different results. Another option is to replace all layers with convolutional
layers. This has been shown to provide some improvement over the
networks that have fully connected layers in their structure. A consequence
of replacing all layers with convolutional ones is that there will be an
increase in the number of parameters for the network <span class="cite">[<a 
href="#Xall_conv">29</a>]</span>. Another
possibility is to replace the rectified linear units with exponential linear units.
According to paper <span class="cite">[<a 
href="#Xelu">8</a>]</span>, this reduces computational complexity and add
significantly better generalization performance than rectified linear units
on networks with more that 5 layers. We would like to try out these
practices and also to try to find new configurations that provide interesting
results.
<!--l. 651--><p class="indent" >  In the near future we plan to create a mobile application which takes pictures
of fruits and labels them accordingly.
<!--l. 653--><p class="indent" >  Another objective is to expand the data set to include more fruits. This is a
more time consuming process since we want to include items that were not used
in most others related papers.
<!--l. 655--><p class="noindent" >
  <h3 class="likesectionHead"><a 
 id="x1-170008"></a>Acknowledgments</h3>
<!--l. 656--><p class="noindent" >A preliminary version of this dataset with 25 fruits was presented during the
Students Communication Session from Babe&#351;-Bolyai University, June
2017.
<!--l. 658--><p class="indent" >
                                                                    

                                                                    
  <h3 class="likesectionHead"><a 
 id="x1-180008"></a>Appendix</h3>
<!--l. 661--><p class="noindent" >In this section we present the source code and project structure used in the
numerical experiment described in this paper. The source code can be
downloaded from GitHub <span class="cite">[<a 
href="#Xfruits_360_github">18</a>]</span>.
<!--l. 663--><p class="indent" >  The source code is organized (on GitHub <span class="cite">[<a 
href="#Xfruits_360_github">18</a>]</span>) as follows:
<!--l. 679--><p class="noindent" >   <!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">root</span><span 
class="txtt-x-x-109">_directory</span>
<!--l. 679--><p class="noindent" >   __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">fruit</span><span 
class="txtt-x-x-109">_detection</span>
<!--l. 679--><p class="noindent" >      __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">detect</span><span 
class="txtt-x-x-109">_fruits.py</span>
<!--l. 679--><p class="noindent" >   __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">network</span>
<!--l. 679--><p class="noindent" >      __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">fruit</span><span 
class="txtt-x-x-109">_test</span><span 
class="txtt-x-x-109">_net.py</span>
<!--l. 679--><p class="noindent" >      __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">fruit</span><span 
class="txtt-x-x-109">_train</span><span 
class="txtt-x-x-109">_net.py</span>
<!--l. 679--><p class="noindent" >   __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">_structure</span>
<!--l. 679--><p class="noindent" >      __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">fruit</span><span 
class="txtt-x-x-109">_network.py</span>
<!--l. 679--><p class="noindent" >      __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">utils.py</span>
<!--l. 679--><p class="noindent" >   __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">utils</span>
<!--l. 679--><p class="noindent" >      __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">build</span><span 
class="txtt-x-x-109">_image</span><span 
class="txtt-x-x-109">_data.py</span>
<!--l. 679--><p class="noindent" >      __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">constants.py</span>
<!--l. 679--><p class="noindent" >      __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">freeze</span><span 
class="txtt-x-x-109">_graph.py</span>
<!--l. 679--><p class="noindent" >      __<!--l. 679--><p class="noindent" ><span 
class="txtt-x-x-109">labels</span>
<!--l. 681--><p class="indent" >  In order to run the project from the command line, first make sure the
PYTHONPATH system variable contains the path to the root_directory. Ensure
that the <span 
class="pxb-x-x-109">utils/constants.py </span>contains the proper paths.
<!--l. 683--><p class="indent" >  Run the <span 
class="pxb-x-x-109">utils/build</span><span 
class="pxb-x-x-109">_image</span><span 
class="pxb-x-x-109">_data.py </span>to generate the tfrecord files with training
and test data. This script is provided in the tensorFlow library. The file
contains several default values for the flags. They can be changed in the
code directly or different values can be provided from the command
line:<br 
class="newline" />python utils/build_image_data.py [flags]
<!--l. 687--><p class="indent" >  where flags can be:
     <ul class="itemize1">
     <li class="itemize">&#8211;train_directory=path to the folder containing the train images
     </li>
     <li class="itemize">&#8211;validation_directory=path  to  the  folder  containing  the  validation
     images
     </li>
     <li class="itemize">&#8211;output_directory=path to where to output the tfrecord files
                                                                    

                                                                    
     </li>
     <li class="itemize">&#8211;labels_file=path to the label file
     </li>
     <li class="itemize">&#8211;train_shards, &#8211;test_shards determine the number of tfrecord files for
     train data and test data
     </li>
     <li class="itemize">&#8211;num_threads is the number of threads to create when creating the
     tfrecord files</li></ul>
<!--l. 701--><p class="indent" >  After the train and test data has been serialized, the train and test scripts can
be run:<br 
class="newline" />python network/fruit_train_net.py<br 
class="newline" />python network/fruit_test_net.py
<!--l. 705--><p class="indent" >  After the training has completed, the python utils/build_image_data.py [flags]
script can be run:<br 
class="newline" />python utils/build_image_data.py &#8211;image_path=&#8221;path to a jpeg file&#8221;
<!--l. 708--><p class="indent" >  Finally, the <span 
class="pxb-x-x-109">utils/freeze</span><span 
class="pxb-x-x-109">_graph.py </span>script, which is also provided as a
utility script in tensorFlow, creates a single file with the trained model
data.
<!--l. 710--><p class="indent" >  python freeze_graph flags
<!--l. 712--><p class="indent" >  These flags are mandatory:
     <ul class="itemize1">
     <li class="itemize">&#8211;input_graph=path to the pbtxt file
     </li>
     <li class="itemize">&#8211;input_checkpoint=path to the ckpt file
     </li>
     <li class="itemize">&#8211;output_graph=name of the output file
     </li>
     <li class="itemize">&#8211;output_node_names=name of the last layer of the network (found in
     the network_structure/fruit_network.py file, in the conv_net method,
     in this case the name of the last layer is &#8221;softmax&#8221;)</li></ul>
<!--l. 724--><p class="indent" >  In the following, we will provide explanations for the code. We will begin
with the definition of the general parameters and configurations of the
project.
<!--l. 726--><p class="indent" >  The following are defined in the <span 
class="pxb-x-x-109">utils/constants.py </span>file:
                                                                    

                                                                    
     <ul class="itemize1">
     <li class="itemize"><span 
class="pxi-x-x-109">root</span><span 
class="pxi-x-x-109">_dir </span>- the top level folder of the project
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">data</span><span 
class="pxi-x-x-109">_dir </span>- the folder where the .tfrecords are persisted
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">fruit</span><span 
class="pxi-x-x-109">_models</span><span 
class="pxi-x-x-109">_dir   </span>-   the   folder   where   the   network   structure   and
     parameters are saved
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">labels</span><span 
class="pxi-x-x-109">_file </span>- the path to the file that contains all the labels used
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">training</span><span 
class="pxi-x-x-109">_images</span><span 
class="pxi-x-x-109">_dir, test</span><span 
class="pxi-x-x-109">_images</span><span 
class="pxi-x-x-109">_dir </span>- paths to the folders containing
     the training and test images
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">number</span><span 
class="pxi-x-x-109">_train</span><span 
class="pxi-x-x-109">_images, number</span><span 
class="pxi-x-x-109">_test</span><span 
class="pxi-x-x-109">_images </span>- number of training and test
     images; used in the test method to calculate accuracy</li></ul>
<!--l. 736--><p class="indent" >  All these configurations can be changed to suit the setup of anyone using the
code.
  <!--l. 738-->
<div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-18001r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">/</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">py</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18002r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">os</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18003r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18004r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">needs</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">be</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">changed</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">according</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">location</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">project</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18005r5"></a><span 
class="pxr-x-x-60">5</span></span><span 
class="txtt-x-x-109">root_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">C</span><span 
class="txtt-x-x-109">:\\</span><span 
class="txtt-x-x-109">root_directory</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18006r6"></a><span 
class="pxr-x-x-60">6</span></span><span 
class="txtt-x-x-109">data_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">root_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">data</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18007r7"></a><span 
class="pxr-x-x-60">7</span></span><span 
class="txtt-x-x-109">fruit_models_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">root_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">fruit_models</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18008r8"></a><span 
class="pxr-x-x-60">8</span></span><span 
class="txtt-x-x-109">labels_file</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">root_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18009r9"></a><span 
class="pxr-x-x-60">9</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18010r10"></a><span 
class="pxr-x-x-60">10</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">change</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">this</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">path</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">folders</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">that</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">hold</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18011r11"></a><span 
class="pxr-x-x-60">11</span></span><span 
class="txtt-x-x-109">training_images_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">Fruit</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">Images</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">Dataset</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">Training</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18012r12"></a><span 
class="pxr-x-x-60">12</span></span><span 
class="txtt-x-x-109">test_images_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">Fruit</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">Images</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">Dataset</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">Test</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18013r13"></a><span 
class="pxr-x-x-60">13</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18014r14"></a><span 
class="pxr-x-x-60">14</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">classes</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">fruit</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">classes</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">resulted</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">due</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">build_image_data</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">py</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">script</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">that</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">leaves</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">first</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">class</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">a</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">background</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">class</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18015r15"></a><span 
class="pxr-x-x-60">15</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">using</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">file</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">that</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">is</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">also</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">used</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">build_image_data</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">py</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18016r16"></a><span 
class="pxr-x-x-60">16</span></span><span 
class="txtt-x-x-109">with</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">open</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">labels_file</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18017r17"></a><span 
class="pxr-x-x-60">17</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">readlines</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18018r18"></a><span 
class="pxr-x-x-60">18</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">num_classes</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">len</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18019r19"></a><span 
class="pxr-x-x-60">19</span></span><span 
class="txtt-x-x-109">number_train_images</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">46371</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18020r20"></a><span 
class="pxr-x-x-60">20</span></span><span 
class="txtt-x-x-109">number_test_images</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">15563</span>
  </div>
<!--l. 761--><p class="indent" >  In the <span 
class="pxb-x-x-109">network</span><span 
class="pxb-x-x-109">_structure/utils.py </span>file we have helper methods used across the
project:
     <ul class="itemize1">
     <li class="itemize"><span 
class="pxi-x-x-109">conv2d </span>combines the TensorFlow method of defining a convolutional layer,
     adding the bias to the convolutional layer and adding rectified linear
     units
          <ul class="itemize2">
          <li class="itemize">a convolutional layer consists of groups of neurons that make
          up kernels
                                                                    

                                                                    
          </li>
          <li class="itemize">the  kernels  have  a  small  size  but  they  always  have  the  same
          depth as the input
          </li>
          <li class="itemize">the neurons from a kernel are connected to a small region of the
          input, called the receptive field, because it is highly inefficient to
          link all neurons to all previous outputs in the case of inputs of
          high dimensions such as images</li></ul>
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">maxpool2d, norml, get</span><span 
class="pxi-x-x-109">_variable, </span><span 
class="pxi-x-x-109">_int64</span><span 
class="pxi-x-x-109">_feature and </span><span 
class="pxi-x-x-109">_bytes</span><span 
class="pxi-x-x-109">_feature </span>simplify the
     calls to the corresponding TensorFlow methods
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">read</span><span 
class="pxi-x-x-109">_files </span>reads multiple tfrecord files and extracts the image data and
     label.</li></ul>
<!--l. 774--><p class="indent" >  Here we also define methods to perform data augmentation on the
input images. Data augmentation is a good way to reduce overfitting on
models.
     <ul class="itemize1">
     <li class="itemize"><span 
class="pxi-x-x-109">adjust</span><span 
class="pxi-x-x-109">_image</span><span 
class="pxi-x-x-109">_for</span><span 
class="pxi-x-x-109">_train </span>applies the following operations on the train
     images
          <ol  class="enumerate1" >
          <li 
  class="enumerate" id="x1-18022x1">Alters the hue of the image
          </li>
          <li 
  class="enumerate" id="x1-18024x2">Alters the saturation of the image
          </li>
          <li 
  class="enumerate" id="x1-18026x3">Flips the image horizontally
          </li>
          <li 
  class="enumerate" id="x1-18028x4">Flips the image vertically
          </li>
          <li 
  class="enumerate" id="x1-18030x5">Converts the image to HSV color space
          </li>
          <li 
  class="enumerate" id="x1-18032x6">Creates a grayscale version of the image and adds it as a fourth
          channel to the HSV image By altering the hue and saturation,
          we simulate having a larger variety of fruits in the images. The
                                                                    

                                                                    
          values with which we alter these properties are small, since in
          nature there is a small color variance between different fruits of
          the same species.</li></ol>
     </li></ul>
<!--l. 787--><p class="indent" >  Flipping the image horizontally and vertically helps prevent the use the
orientation of the fruit as a feature when training. This should result in fruits
being correctly classified regardless of their position in an image.
     <ul class="itemize1">
     <li class="itemize"><span 
class="pxi-x-x-109">adjust</span><span 
class="pxi-x-x-109">_image</span><span 
class="pxi-x-x-109">_for</span><span 
class="pxi-x-x-109">_test </span>converts the input image to HSV and adds the
     fourth grayscale channel</li></ul>
  <!--l. 792-->
<div class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-18033r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">network_structure</span><span 
class="txtt-x-x-109">/</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">py</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18034r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18035r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensorflow</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18036r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18037r5"></a><span 
class="pxr-x-x-60">5</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18038r6"></a><span 
class="pxr-x-x-60">6</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">perform</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">data</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">augmentation</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">on</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18039r7"></a><span 
class="pxr-x-x-60">7</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">add</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">random</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">hue</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saturation</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18040r8"></a><span 
class="pxr-x-x-60">8</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">randomly</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">flip</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">vertically</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">horizontally</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18041r9"></a><span 
class="pxr-x-x-60">9</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">converts</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">RGB</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">HSV</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18042r10"></a><span 
class="pxr-x-x-60">10</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">adds</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">a</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">4</span><span 
class="txtt-x-x-109">th</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">channel</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">HSV</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">ones</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">that</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">contains</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">gray</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">scale</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18043r11"></a><span 
class="pxr-x-x-60">11</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">adjust_image_for_train</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18044r12"></a><span 
class="pxr-x-x-60">12</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">convert_image_dtype</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18045r13"></a><span 
class="pxr-x-x-60">13</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">random_hue</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0.02)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18046r14"></a><span 
class="pxr-x-x-60">14</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">random_saturation</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0.9,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1.2)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18047r15"></a><span 
class="pxr-x-x-60">15</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">random_flip_left_right</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18048r16"></a><span 
class="pxr-x-x-60">16</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">random_flip_up_down</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18049r17"></a><span 
class="pxr-x-x-60">17</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">hsv_image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">rgb_to_hsv</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18050r18"></a><span 
class="pxr-x-x-60">18</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">gray_image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">rgb_to_grayscale</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18051r19"></a><span 
class="pxr-x-x-60">19</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">rez</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">concat</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">hsv_image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">gray_image</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">2)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18052r20"></a><span 
class="pxr-x-x-60">20</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">rez</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18053r21"></a><span 
class="pxr-x-x-60">21</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18054r22"></a><span 
class="pxr-x-x-60">22</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18055r23"></a><span 
class="pxr-x-x-60">23</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">test</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">just</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">convert</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">HSV</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">add</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">gray</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">scale</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">channel</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18056r24"></a><span 
class="pxr-x-x-60">24</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">adjust_image_for_test</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18057r25"></a><span 
class="pxr-x-x-60">25</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">convert_image_dtype</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18058r26"></a><span 
class="pxr-x-x-60">26</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">gray_image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">rgb_to_grayscale</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18059r27"></a><span 
class="pxr-x-x-60">27</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">rgb_to_hsv</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18060r28"></a><span 
class="pxr-x-x-60">28</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">rez</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">concat</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">gray_image</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">2)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18061r29"></a><span 
class="pxr-x-x-60">29</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">rez</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18062r30"></a><span 
class="pxr-x-x-60">30</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18063r31"></a><span 
class="pxr-x-x-60">31</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18064r32"></a><span 
class="pxr-x-x-60">32</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">_int64_feature</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18065r33"></a><span 
class="pxr-x-x-60">33</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">not</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">isinstance</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">list</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18066r34"></a><span 
class="pxr-x-x-60">34</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">]</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18067r35"></a><span 
class="pxr-x-x-60">35</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Feature</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">int64_list</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Int64List</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18068r36"></a><span 
class="pxr-x-x-60">36</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18069r37"></a><span 
class="pxr-x-x-60">37</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18070r38"></a><span 
class="pxr-x-x-60">38</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">_bytes_feature</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18071r39"></a><span 
class="pxr-x-x-60">39</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Feature</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">bytes_list</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">BytesList</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">=[</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18072r40"></a><span 
class="pxr-x-x-60">40</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18073r41"></a><span 
class="pxr-x-x-60">41</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18074r42"></a><span 
class="pxr-x-x-60">42</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">read</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">an</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensor</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tfrecord</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">files</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18075r43"></a><span 
class="pxr-x-x-60">43</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">read_files</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">filenames</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18076r44"></a><span 
class="pxr-x-x-60">44</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">file_queue</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">string_input_producer</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">filenames</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18077r45"></a><span 
class="pxr-x-x-60">45</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">reader</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">TFRecordReader</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18078r46"></a><span 
class="pxr-x-x-60">46</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">_</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">serialized_example</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">reader</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">read</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">file_queue</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18079r47"></a><span 
class="pxr-x-x-60">47</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">features</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">parse_single_example</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18080r48"></a><span 
class="pxr-x-x-60">48</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">serialized_example</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18081r49"></a><span 
class="pxr-x-x-60">49</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">features</span><span 
class="txtt-x-x-109">={</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18082r50"></a><span 
class="pxr-x-x-60">50</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">image_raw</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">FixedLenFeature</span><span 
class="txtt-x-x-109">([],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">string</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18083r51"></a><span 
class="pxr-x-x-60">51</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">FixedLenFeature</span><span 
class="txtt-x-x-109">([],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">int64</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18084r52"></a><span 
class="pxr-x-x-60">52</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">height</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">FixedLenFeature</span><span 
class="txtt-x-x-109">([],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">int64</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18085r53"></a><span 
class="pxr-x-x-60">53</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">width</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">FixedLenFeature</span><span 
class="txtt-x-x-109">([],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">int64</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18086r54"></a><span 
class="pxr-x-x-60">54</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">}</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18087r55"></a><span 
class="pxr-x-x-60">55</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18088r56"></a><span 
class="pxr-x-x-60">56</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">decode_jpeg</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">features</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">image_raw</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">channels</span><span 
class="txtt-x-x-109">=3)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18089r57"></a><span 
class="pxr-x-x-60">57</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reshape</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[100,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">100,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">3])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18090r58"></a><span 
class="pxr-x-x-60">58</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">cast</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">features</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">int32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18091r59"></a><span 
class="pxr-x-x-60">59</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18092r60"></a><span 
class="pxr-x-x-60">60</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18093r61"></a><span 
class="pxr-x-x-60">61</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18094r62"></a><span 
class="pxr-x-x-60">62</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">get_variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">shape</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">initializer</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18095r63"></a><span 
class="pxr-x-x-60">63</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">shape</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">initializer</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">initializer</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dtype</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18096r64"></a><span 
class="pxr-x-x-60">64</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18097r65"></a><span 
class="pxr-x-x-60">65</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18098r66"></a><span 
class="pxr-x-x-60">66</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">op_name</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">W</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">b</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">strides</span><span 
class="txtt-x-x-109">=1)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18099r67"></a><span 
class="pxr-x-x-60">67</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">conv2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">W</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">strides</span><span 
class="txtt-x-x-109">=[1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">strides</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">strides</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">padding</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">SAME</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">op_name</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18100r68"></a><span 
class="pxr-x-x-60">68</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">bias_add</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">b</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18101r69"></a><span 
class="pxr-x-x-60">69</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">relu</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18102r70"></a><span 
class="pxr-x-x-60">70</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18103r71"></a><span 
class="pxr-x-x-60">71</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18104r72"></a><span 
class="pxr-x-x-60">72</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">maxpool2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">op_name</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">k</span><span 
class="txtt-x-x-109">=2)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18105r73"></a><span 
class="pxr-x-x-60">73</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">max_pool</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">ksize</span><span 
class="txtt-x-x-109">=[1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">k</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">k</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">strides</span><span 
class="txtt-x-x-109">=[1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">k</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">k</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">padding</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">SAME</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">op_name</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18106r74"></a><span 
class="pxr-x-x-60">74</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18107r75"></a><span 
class="pxr-x-x-60">75</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18108r76"></a><span 
class="pxr-x-x-60">76</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">norml</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">op_name</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18109r77"></a><span 
class="pxr-x-x-60">77</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">lrn</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">4,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">bias</span><span 
class="txtt-x-x-109">=1.0,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">alpha</span><span 
class="txtt-x-x-109">=0.001</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">/</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">9.0,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">beta</span><span 
class="txtt-x-x-109">=0.75,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">op_name</span><span 
class="txtt-x-x-109">)</span>
  </div>
<!--l. 873--><p class="indent" >  Following, in the <span 
class="pxb-x-x-109">network</span><span 
class="pxb-x-x-109">_structure/fruit</span><span 
class="pxb-x-x-109">_network.py </span>file we have network
parameters and the method that defines the network structure.
     <ul class="itemize1">
     <li class="itemize"><span 
class="pxi-x-x-109">IMAGE</span><span 
class="pxi-x-x-109">_HEIGHT, IMAGE</span><span 
class="pxi-x-x-109">_WIDTH, IMAGE</span><span 
class="pxi-x-x-109">_CHANNELS </span>- the image
     height, width and depth respectively;
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">NETWORK</span><span 
class="pxi-x-x-109">_DEPTH </span>- the depth of the input for the network (3 from
     HSV image + 1 from grayscale image)
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">number</span><span 
class="pxi-x-x-109">_of</span><span 
class="pxi-x-x-109">_act</span><span 
class="pxi-x-x-109">_maps</span><span 
class="pxi-x-x-109">_conv</span><span 
class="pxi-x-x-109">_# </span>- the number of activation maps for each
     convolutional layer
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">number</span><span 
class="pxi-x-x-109">_of</span><span 
class="pxi-x-x-109">_fcl</span><span 
class="pxi-x-x-109">_outputs</span><span 
class="pxi-x-x-109">_# </span>- the number of units for each fully connected
     layer
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">num</span><span 
class="pxi-x-x-109">_classes </span>- the number of different classes used
                                                                    

                                                                    
          <ul class="itemize2">
          <li class="itemize">it is determined by counting the number of folders in the Training
          folder</li></ul>
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">batch</span><span 
class="pxi-x-x-109">_size </span>- the number of images selected in each training/testing
     step
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">dropout </span>- the probability to keep a node in each training step
          <ul class="itemize2">
          <li class="itemize">during training, at each iteration, some nodes are ignored with
          probability 1 <span 
class="pxsy-x-x-109">- </span><span 
class="pxmi-x-x-109">dropout</span>
          </li>
          <li class="itemize">this  results  in  a  reduced  network,  which  is  then  used  for  a
          forward or backward pass
          </li>
          <li class="itemize">dropout prevents neurons from developing co-dependency and,
          in turn, overfitting
          </li>
          <li class="itemize">outside of training, the dropout is ignored and the entire network
          is used for classifying</li></ul>
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">update</span><span 
class="pxi-x-x-109">_learning</span><span 
class="pxi-x-x-109">_rate </span>dynamically adjusts the learning rate as training
     progresses
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">weights, biases </span>- are variables that hold the specifications for the layers
     used
          <ul class="itemize2">
          <li class="itemize">The first layer (Convolution #1) is a convolutional layer which
          applies  16  5  x  5  filters.  On  this  layer  we  apply  max  pooling
          with a filter of shape 2 x 2 with stride 2 which specifies that the
          pooled regions do not overlap (Max-Pool #1). This also reduces
          the width and height to 50 pixels each.
                                                                    

                                                                    
          </li>
          <li class="itemize">The second convolutional (Convolution #2) layer applies 32 5 x 5
          filters which outputs 32 activation maps. We apply on this layer
          the same kind of max pooling(Max-Pool #2) as on the first layer,
          shape 2 x 2 and stride 2.
          </li>
          <li class="itemize">The  third  convolutional  (Convolution  #3)  layer  applies  64  5  x
          5 filters. Following is another max pool layer(Max-Pool #3) of
          shape 2 x 2 and stride 2.
          </li>
          <li class="itemize">The fourth convolutional (Convolution #4) layer applies 128 5 x
          5 filters after which we apply a final max pool layer (Max-Pool
          #4).
          </li>
          <li class="itemize">Because of the four max pooling layers, the dimensions of the
          representation have each been reduced by a factor of 16, therefore
          the fifth layer, which is a fully connected layer(Fully Connected
          #1), has 7 x 7 x 16 inputs.
          </li>
          <li class="itemize">This   layer   feeds   into   another   fully   connected   layer   (Fully
          Connected #2) with 1024 inputs and 256 outputs.
          </li>
          <li class="itemize">The last layer is a softmax loss layer (Softmax) with 256 inputs.
          The number of outputs is equal to the number of classes.</li></ul>
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">new</span><span 
class="pxi-x-x-109">_height, new</span><span 
class="pxi-x-x-109">_width </span>- the height and width after the applying all the
     convolutional and max pool layers; the formula used works because all the
     max pool layers have 2 x 2 filters with stride 2; should the configuration
     change, the formula used must be changed;</li></ul>
  <!--l. 909-->
<div class="lstlisting" id="listing-8"><span class="label"><a 
 id="x1-18112r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">network_structure</span><span 
class="txtt-x-x-109">/</span><span 
class="txtt-x-x-109">fruit_network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">py</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18113r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18114r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensorflow</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18115r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">math</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18116r5"></a><span 
class="pxr-x-x-60">5</span></span><span 
class="txbtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18117r6"></a><span 
class="pxr-x-x-60">6</span></span><span 
class="txbtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18118r7"></a><span 
class="pxr-x-x-60">7</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18119r8"></a><span 
class="pxr-x-x-60">8</span></span><span 
class="txtt-x-x-109">HEIGHT</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">100</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18120r9"></a><span 
class="pxr-x-x-60">9</span></span><span 
class="txtt-x-x-109">WIDTH</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">100</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18121r10"></a><span 
class="pxr-x-x-60">10</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">channels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">an</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">jpeg</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">has</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">RGB</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">channels</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18122r11"></a><span 
class="pxr-x-x-60">11</span></span><span 
class="txtt-x-x-109">CHANNELS</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">3</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18123r12"></a><span 
class="pxr-x-x-60">12</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">channels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">input</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">layer</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">HSV</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">gray</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">scale</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18124r13"></a><span 
class="pxr-x-x-60">13</span></span><span 
class="txtt-x-x-109">NETWORK_DEPTH</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">4</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18125r14"></a><span 
class="pxr-x-x-60">14</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18126r15"></a><span 
class="pxr-x-x-60">15</span></span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">60</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18127r16"></a><span 
class="pxr-x-x-60">16</span></span><span 
class="txtt-x-x-109">input_size</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">HEIGHT</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">*</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">WIDTH</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">*</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">NETWORK_DEPTH</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18128r17"></a><span 
class="pxr-x-x-60">17</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">max</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">pool</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">operations</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">used</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">structure</span><span 
class="txtt-x-x-109">;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18129r18"></a><span 
class="pxr-x-x-60">18</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">used</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">when</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">calculating</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">input</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">size</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">first</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">fully</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">connected</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">layer</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18130r19"></a><span 
class="pxr-x-x-60">19</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">MUST</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">BE</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">UPDATED</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">max</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">pool</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">operations</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">changes</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">or</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">stride</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">max</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">pool</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">changes</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18131r20"></a><span 
class="pxr-x-x-60">20</span></span><span 
class="txtt-x-x-109">number_of_max_pools</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">4</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18132r21"></a><span 
class="pxr-x-x-60">21</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">this</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">works</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">because</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">each</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">max</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">pool</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">layer</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">has</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">a</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">2</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">2</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">filter</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">stride</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">2</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18133r22"></a><span 
class="pxr-x-x-60">22</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">case</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">this</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">changes</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">formula</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">will</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">no</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">longer</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">be</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">accurate</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18134r23"></a><span 
class="pxr-x-x-60">23</span></span><span 
class="txtt-x-x-109">new_width</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">math</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">ceil</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">WIDTH</span><span 
class="txtt-x-x-109">/(1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x003C;&#x003C;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_max_pools</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18135r24"></a><span 
class="pxr-x-x-60">24</span></span><span 
class="txtt-x-x-109">new_height</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">math</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">ceil</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">HEIGHT</span><span 
class="txtt-x-x-109">/(1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x003C;&#x003C;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_max_pools</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18136r25"></a><span 
class="pxr-x-x-60">25</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">probability</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">values</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">after</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">a</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">training</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">iteration</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18137r26"></a><span 
class="pxr-x-x-60">26</span></span><span 
class="txtt-x-x-109">dropout</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0.8</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18138r27"></a><span 
class="pxr-x-x-60">27</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18139r28"></a><span 
class="pxr-x-x-60">28</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">placeholder</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">input</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">layer</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18140r29"></a><span 
class="pxr-x-x-60">29</span></span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">placeholder</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">None</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">input_size</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18141r30"></a><span 
class="pxr-x-x-60">30</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">placeholder</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">actual</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18142r31"></a><span 
class="pxr-x-x-60">31</span></span><span 
class="txtt-x-x-109">Y</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">placeholder</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">int64</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">Y</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18143r32"></a><span 
class="pxr-x-x-60">32</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18144r33"></a><span 
class="pxr-x-x-60">33</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">activation</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">maps</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">each</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">convolutional</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">layer</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18145r34"></a><span 
class="pxr-x-x-60">34</span></span><span 
class="txtt-x-x-109">number_of_act_maps_conv1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">16</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18146r35"></a><span 
class="pxr-x-x-60">35</span></span><span 
class="txtt-x-x-109">number_of_act_maps_conv2</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">32</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18147r36"></a><span 
class="pxr-x-x-60">36</span></span><span 
class="txtt-x-x-109">number_of_act_maps_conv3</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">64</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18148r37"></a><span 
class="pxr-x-x-60">37</span></span><span 
class="txtt-x-x-109">number_of_act_maps_conv4</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">128</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18149r38"></a><span 
class="pxr-x-x-60">38</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18150r39"></a><span 
class="pxr-x-x-60">39</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">outputs</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">each</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">fully</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">connected</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">layer</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18151r40"></a><span 
class="pxr-x-x-60">40</span></span><span 
class="txtt-x-x-109">number_of_fcl_outputs1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1024</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18152r41"></a><span 
class="pxr-x-x-60">41</span></span><span 
class="txtt-x-x-109">number_of_fcl_outputs2</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">256</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18153r42"></a><span 
class="pxr-x-x-60">42</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18154r43"></a><span 
class="pxr-x-x-60">43</span></span><span 
class="txtt-x-x-109">initial_learning_rate</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0.001</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18155r44"></a><span 
class="pxr-x-x-60">44</span></span><span 
class="txtt-x-x-109">final_learning_rate</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0.00001</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18156r45"></a><span 
class="pxr-x-x-60">45</span></span><span 
class="txtt-x-x-109">learning_rate</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">initial_learning_rate</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18157r46"></a><span 
class="pxr-x-x-60">46</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18158r47"></a><span 
class="pxr-x-x-60">47</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18159r48"></a><span 
class="pxr-x-x-60">48</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv_net</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dropout</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18160r49"></a><span 
class="pxr-x-x-60">49</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reshape</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">shape</span><span 
class="txtt-x-x-109">=[-1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">HEIGHT</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">WIDTH</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">NETWORK_DEPTH</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18161r50"></a><span 
class="pxr-x-x-60">50</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18162r51"></a><span 
class="pxr-x-x-60">51</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">conv2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_bias1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18163r52"></a><span 
class="pxr-x-x-60">52</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">maxpool2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">max_pool1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv1</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">k</span><span 
class="txtt-x-x-109">=2)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18164r53"></a><span 
class="pxr-x-x-60">53</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18165r54"></a><span 
class="pxr-x-x-60">54</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv2</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">conv2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv1</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_bias2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18166r55"></a><span 
class="pxr-x-x-60">55</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv2</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">maxpool2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">max_pool2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv2</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">k</span><span 
class="txtt-x-x-109">=2)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18167r56"></a><span 
class="pxr-x-x-60">56</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18168r57"></a><span 
class="pxr-x-x-60">57</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv3</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">conv2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv3</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv2</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight3</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_bias3</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18169r58"></a><span 
class="pxr-x-x-60">58</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv3</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">maxpool2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">max_pool3</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv3</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">k</span><span 
class="txtt-x-x-109">=2)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18170r59"></a><span 
class="pxr-x-x-60">59</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18171r60"></a><span 
class="pxr-x-x-60">60</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv4</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">conv2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv4</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv3</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight4</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_bias4</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18172r61"></a><span 
class="pxr-x-x-60">61</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv4</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">maxpool2d</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">max_pool4</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">conv4</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">k</span><span 
class="txtt-x-x-109">=2)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18173r62"></a><span 
class="pxr-x-x-60">62</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18174r63"></a><span 
class="pxr-x-x-60">63</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">fc1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reshape</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">conv4</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">shape</span><span 
class="txtt-x-x-109">=[-1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_weight1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">].</span><span 
class="txtt-x-x-109">get_shape</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">as_list</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">[0]])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18175r64"></a><span 
class="pxr-x-x-60">64</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">fc1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">relu</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">add</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">matmul</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">fc1</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_weight1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_bias1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18176r65"></a><span 
class="pxr-x-x-60">65</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">fc1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">dropout</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">fc1</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dropout</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18177r66"></a><span 
class="pxr-x-x-60">66</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18178r67"></a><span 
class="pxr-x-x-60">67</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">fc2</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">relu</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">add</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">matmul</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">fc1</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_weight2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_bias2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18179r68"></a><span 
class="pxr-x-x-60">68</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">fc2</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">dropout</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">fc2</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dropout</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18180r69"></a><span 
class="pxr-x-x-60">69</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18181r70"></a><span 
class="pxr-x-x-60">70</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">out</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">add</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">matmul</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">fc2</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">out_weight</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">out_bias</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18182r71"></a><span 
class="pxr-x-x-60">71</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">out</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18183r72"></a><span 
class="pxr-x-x-60">72</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18184r73"></a><span 
class="pxr-x-x-60">73</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18185r74"></a><span 
class="pxr-x-x-60">74</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">update_learning_rate</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">acc</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">learn_rate</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18186r75"></a><span 
class="pxr-x-x-60">75</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">max</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">learn_rate</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">acc</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">*</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">learn_rate</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">*</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0.9,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">final_learning_rate</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18187r76"></a><span 
class="pxr-x-x-60">76</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18188r77"></a><span 
class="pxr-x-x-60">77</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18189r78"></a><span 
class="pxr-x-x-60">78</span></span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">{</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18190r79"></a><span 
class="pxr-x-x-60">79</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[5,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">5,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">NETWORK_DEPTH</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_act_maps_conv1</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">truncated_normal_initializer</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">stddev</span><span 
class="txtt-x-x-109">=5</span><span 
class="txtt-x-x-109">e</span><span 
class="txtt-x-x-109">-2,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dtype</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18191r80"></a><span 
class="pxr-x-x-60">80</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18192r81"></a><span 
class="pxr-x-x-60">81</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[5,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">5,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_act_maps_conv1</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_act_maps_conv2</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">truncated_normal_initializer</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">stddev</span><span 
class="txtt-x-x-109">=5</span><span 
class="txtt-x-x-109">e</span><span 
class="txtt-x-x-109">-2,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dtype</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18193r82"></a><span 
class="pxr-x-x-60">82</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18194r83"></a><span 
class="pxr-x-x-60">83</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight3</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight3</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[5,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">5,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_act_maps_conv2</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_act_maps_conv3</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">truncated_normal_initializer</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">stddev</span><span 
class="txtt-x-x-109">=5</span><span 
class="txtt-x-x-109">e</span><span 
class="txtt-x-x-109">-2,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dtype</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18195r84"></a><span 
class="pxr-x-x-60">84</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18196r85"></a><span 
class="pxr-x-x-60">85</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight4</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_weight4</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[5,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">5,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_act_maps_conv3</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_act_maps_conv4</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">truncated_normal_initializer</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">stddev</span><span 
class="txtt-x-x-109">=5</span><span 
class="txtt-x-x-109">e</span><span 
class="txtt-x-x-109">-2,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dtype</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18197r86"></a><span 
class="pxr-x-x-60">86</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18198r87"></a><span 
class="pxr-x-x-60">87</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_weight1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_weight1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">new_width</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">*</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">new_height</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">*</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_act_maps_conv4</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_fcl_outputs1</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">truncated_normal_initializer</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">stddev</span><span 
class="txtt-x-x-109">=5</span><span 
class="txtt-x-x-109">e</span><span 
class="txtt-x-x-109">-2,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dtype</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18199r88"></a><span 
class="pxr-x-x-60">88</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18200r89"></a><span 
class="pxr-x-x-60">89</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_weight2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_weight2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">number_of_fcl_outputs1</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number_of_fcl_outputs2</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">truncated_normal_initializer</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">stddev</span><span 
class="txtt-x-x-109">=5</span><span 
class="txtt-x-x-109">e</span><span 
class="txtt-x-x-109">-2,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dtype</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18201r90"></a><span 
class="pxr-x-x-60">90</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">out_weight</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">out_weight</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">number_of_fcl_outputs2</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">num_classes</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">truncated_normal_initializer</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">stddev</span><span 
class="txtt-x-x-109">=5</span><span 
class="txtt-x-x-109">e</span><span 
class="txtt-x-x-109">-2,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">dtype</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18202r91"></a><span 
class="pxr-x-x-60">91</span></span><span 
class="txtt-x-x-109">}</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18203r92"></a><span 
class="pxr-x-x-60">92</span></span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">{</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18204r93"></a><span 
class="pxr-x-x-60">93</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_bias1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">zeros</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">number_of_act_maps_conv1</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18205r94"></a><span 
class="pxr-x-x-60">94</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_bias2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">zeros</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">number_of_act_maps_conv2</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18206r95"></a><span 
class="pxr-x-x-60">95</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_bias3</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">zeros</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">number_of_act_maps_conv3</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18207r96"></a><span 
class="pxr-x-x-60">96</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">conv_bias4</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">zeros</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">number_of_act_maps_conv4</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18208r97"></a><span 
class="pxr-x-x-60">97</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_bias1</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">zeros</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">number_of_fcl_outputs1</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18209r98"></a><span 
class="pxr-x-x-60">98</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">fcl_bias2</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">zeros</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">number_of_fcl_outputs2</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18210r99"></a><span 
class="pxr-x-x-60">99</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">out_bias</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Variable</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">zeros</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">num_classes</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18211r100"></a><span 
class="pxr-x-x-60">100</span></span><span 
class="txtt-x-x-109">}</span>
  </div>
<!--l. 1013--><p class="indent" >  The following 2 files, <span 
class="pxb-x-x-109">network/fruit</span><span 
class="pxb-x-x-109">_test</span><span 
class="pxb-x-x-109">_net.py, network/fruit</span><span 
class="pxb-x-x-109">_train</span><span 
class="pxb-x-x-109">_net.py</span>
contain the logic for training and testing the network Firstly, in
<span 
class="pxb-x-x-109">network/fruit</span><span 
class="pxb-x-x-109">_train</span><span 
class="pxb-x-x-109">_net.py </span>we have:
                                                                    

                                                                    
     <ul class="itemize1">
     <li class="itemize"><span 
class="pxi-x-x-109">iterations </span>- the number of steps for which the training will be done
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">display</span><span 
class="pxi-x-x-109">_interval </span>- the number of iterations to train for before displaying
     the loss and accuracy of the network
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">useCkpt  </span>-  if  true,  load  a  previously  trained  model  and  continue
     training, else, train a new model from scratch
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">inputs </span>- read the tfrecord files and prepare a queue of images split into
     shuffled batches
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">train</span><span 
class="pxi-x-x-109">_model </span>- runs the training process</li></ul>
  <!--l. 1023-->
<div class="lstlisting" id="listing-9"><span class="label"><a 
 id="x1-18214r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">/</span><span 
class="txtt-x-x-109">fruit_train_net</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">py</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18215r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18216r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensorflow</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18217r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">numpy</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">np</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18218r5"></a><span 
class="pxr-x-x-60">5</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">time</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18219r6"></a><span 
class="pxr-x-x-60">6</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">os</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18220r7"></a><span 
class="pxr-x-x-60">7</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">re</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18221r8"></a><span 
class="pxr-x-x-60">8</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18222r9"></a><span 
class="pxr-x-x-60">9</span></span><span 
class="txbtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network_structure</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">fruit_network</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18223r10"></a><span 
class="pxr-x-x-60">10</span></span><span 
class="txbtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network_structure</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18224r11"></a><span 
class="pxr-x-x-60">11</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18225r12"></a><span 
class="pxr-x-x-60">12</span></span><span 
class="txbtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18226r13"></a><span 
class="pxr-x-x-60">13</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18227r14"></a><span 
class="pxr-x-x-60">14</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">default</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">iterations</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">training</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18228r15"></a><span 
class="pxr-x-x-60">15</span></span><span 
class="txtt-x-x-109">iterations</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">75000</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18229r16"></a><span 
class="pxr-x-x-60">16</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">default</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">amount</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">iterations</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">after</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">we</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">display</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">loss</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">accuracy</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18230r17"></a><span 
class="pxr-x-x-60">17</span></span><span 
class="txtt-x-x-109">display_interval</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">250</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18231r18"></a><span 
class="pxr-x-x-60">18</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">use</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saved</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">model</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">continue</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">training</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18232r19"></a><span 
class="pxr-x-x-60">19</span></span><span 
class="txtt-x-x-109">useCkpt</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">False</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18233r20"></a><span 
class="pxr-x-x-60">20</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">placeholder</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">probability</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">parameters</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">after</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">an</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">iteration</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18234r21"></a><span 
class="pxr-x-x-60">21</span></span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">placeholder</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18235r22"></a><span 
class="pxr-x-x-60">22</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18236r23"></a><span 
class="pxr-x-x-60">23</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">prepare</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">input</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensors</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18237r24"></a><span 
class="pxr-x-x-60">24</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">inputs</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">filenames</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18238r25"></a><span 
class="pxr-x-x-60">25</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">read_files</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">filenames</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18239r26"></a><span 
class="pxr-x-x-60">26</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">adjust_image_for_train</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18240r27"></a><span 
class="pxr-x-x-60">27</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">shuffle_batch</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18241r28"></a><span 
class="pxr-x-x-60">28</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18242r29"></a><span 
class="pxr-x-x-60">29</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18243r30"></a><span 
class="pxr-x-x-60">30</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">capacity</span><span 
class="txtt-x-x-109">=35000</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18244r31"></a><span 
class="pxr-x-x-60">31</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">min_after_dequeue</span><span 
class="txtt-x-x-109">=5000,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18245r32"></a><span 
class="pxr-x-x-60">32</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">allow_smaller_final_batch</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">True</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18246r33"></a><span 
class="pxr-x-x-60">33</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18247r34"></a><span 
class="pxr-x-x-60">34</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18248r35"></a><span 
class="pxr-x-x-60">35</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">build</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18249r36"></a><span 
class="pxr-x-x-60">36</span></span><span 
class="txtt-x-x-109">logits</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">conv_net</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18250r37"></a><span 
class="pxr-x-x-60">37</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">apply</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">on</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">final</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">layer</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18251r38"></a><span 
class="pxr-x-x-60">38</span></span><span 
class="txtt-x-x-109">prediction</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">logits</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18252r39"></a><span 
class="pxr-x-x-60">39</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18253r40"></a><span 
class="pxr-x-x-60">40</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">calculate</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">loss</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">using</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">predicted</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">vs</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">expected</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18254r41"></a><span 
class="pxr-x-x-60">41</span></span><span 
class="txtt-x-x-109">loss_operation</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reduce_mean</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18255r42"></a><span 
class="pxr-x-x-60">42</span></span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">sparse_softmax_cross_entropy_with_logits</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">logits</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">logits</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Y</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18256r43"></a><span 
class="pxr-x-x-60">43</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18257r44"></a><span 
class="pxr-x-x-60">44</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">use</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">adaptive</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">moment</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">estimation</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">optimizer</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18258r45"></a><span 
class="pxr-x-x-60">45</span></span><span 
class="txtt-x-x-109">optimizer</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">AdamOptimizer</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">learning_rate</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">learning_rate</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18259r46"></a><span 
class="pxr-x-x-60">46</span></span><span 
class="txtt-x-x-109">train_op</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">optimizer</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">minimize</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">loss</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">loss_operation</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18260r47"></a><span 
class="pxr-x-x-60">47</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18261r48"></a><span 
class="pxr-x-x-60">48</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">calculate</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">accuracy</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">this</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">training</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">step</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18262r49"></a><span 
class="pxr-x-x-60">49</span></span><span 
class="txtt-x-x-109">correct_prediction</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">equal</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">argmax</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">prediction</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Y</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18263r50"></a><span 
class="pxr-x-x-60">50</span></span><span 
class="txtt-x-x-109">accuracy</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reduce_mean</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">cast</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">correct_prediction</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18264r51"></a><span 
class="pxr-x-x-60">51</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18265r52"></a><span 
class="pxr-x-x-60">52</span></span><span 
class="txtt-x-x-109">init</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">global_variables_initializer</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18266r53"></a><span 
class="pxr-x-x-60">53</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18267r54"></a><span 
class="pxr-x-x-60">54</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18268r55"></a><span 
class="pxr-x-x-60">55</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">train_model</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18269r56"></a><span 
class="pxr-x-x-60">56</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">time1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">time</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">time</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18270r57"></a><span 
class="pxr-x-x-60">57</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">i</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">range</span><span 
class="txtt-x-x-109">(1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">iterations</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18271r58"></a><span 
class="pxr-x-x-60">58</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">with</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Graph</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">as_default</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18272r59"></a><span 
class="pxr-x-x-60">59</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18273r60"></a><span 
class="pxr-x-x-60">60</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_y</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18274r61"></a><span 
class="pxr-x-x-60">61</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_x</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">np</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reshape</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">batch_x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">input_size</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18275r62"></a><span 
class="pxr-x-x-60">62</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18276r63"></a><span 
class="pxr-x-x-60">63</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">train_op</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">feed_dict</span><span 
class="txtt-x-x-109">={</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Y</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_y</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">dropout</span><span 
class="txtt-x-x-109">})</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18277r64"></a><span 
class="pxr-x-x-60">64</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18278r65"></a><span 
class="pxr-x-x-60">65</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">i</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">display_interval</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">==</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">or</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">i</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">==</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18279r66"></a><span 
class="pxr-x-x-60">66</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">loss</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">acc</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">loss_operation</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">accuracy</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">feed_dict</span><span 
class="txtt-x-x-109">={</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Y</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_y</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1})</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18280r67"></a><span 
class="pxr-x-x-60">67</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">learning_rate</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">update_learning_rate</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">acc</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">learn_rate</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">initial_learning_rate</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18281r68"></a><span 
class="pxr-x-x-60">68</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">save</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">meta</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">data</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">graph</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18282r69"></a><span 
class="pxr-x-x-60">69</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saver</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">save</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">fruit_models_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">model</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">ckpt</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18283r70"></a><span 
class="pxr-x-x-60">70</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">write_graph</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">graph_def</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">fruit_models_dir</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">graph</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">pbtxt</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18284r71"></a><span 
class="pxr-x-x-60">71</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">time2</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">time</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">time</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18285r72"></a><span 
class="pxr-x-x-60">72</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">print</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">time</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%.4</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">step</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">d</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">loss</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%.4</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">accuracy</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%.4</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">time2</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">time1</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">i</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">loss</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">acc</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18286r73"></a><span 
class="pxr-x-x-60">73</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">time1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">time</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">time</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18287r74"></a><span 
class="pxr-x-x-60">74</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18288r75"></a><span 
class="pxr-x-x-60">75</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18289r76"></a><span 
class="pxr-x-x-60">76</span></span><span 
class="txtt-x-x-109">saver</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Saver</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18290r77"></a><span 
class="pxr-x-x-60">77</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18291r78"></a><span 
class="pxr-x-x-60">78</span></span><span 
class="txtt-x-x-109">with</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Session</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18292r79"></a><span 
class="pxr-x-x-60">79</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">init</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18293r80"></a><span 
class="pxr-x-x-60">80</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">input</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tfrecord</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">files</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18294r81"></a><span 
class="pxr-x-x-60">81</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tfrecords_files</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[(</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">data_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">os</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">listdir</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">data_dir</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">re</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">match</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">]</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18295r82"></a><span 
class="pxr-x-x-60">82</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">inputs</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tfrecords_files</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18296r83"></a><span 
class="pxr-x-x-60">83</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Coordinator</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18297r84"></a><span 
class="pxr-x-x-60">84</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">threads</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">start_queue_runners</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18298r85"></a><span 
class="pxr-x-x-60">85</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18299r86"></a><span 
class="pxr-x-x-60">86</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">restore</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">previously</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saved</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">value</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">we</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">wish</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">continue</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">training</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18300r87"></a><span 
class="pxr-x-x-60">87</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">useCkpt</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18301r88"></a><span 
class="pxr-x-x-60">88</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">ckpt</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_checkpoint_state</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">fruit_models_dir</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18302r89"></a><span 
class="pxr-x-x-60">89</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saver</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">restore</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">ckpt</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">model_checkpoint_path</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18303r90"></a><span 
class="pxr-x-x-60">90</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18304r91"></a><span 
class="pxr-x-x-60">91</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">train_model</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18305r92"></a><span 
class="pxr-x-x-60">92</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18306r93"></a><span 
class="pxr-x-x-60">93</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">request_stop</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18307r94"></a><span 
class="pxr-x-x-60">94</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">join</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">threads</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18308r95"></a><span 
class="pxr-x-x-60">95</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">close</span><span 
class="txtt-x-x-109">()</span>
  </div>
<!--l. 1122--><p class="indent" >  Secondly, in <span 
class="pxb-x-x-109">network/fruit</span><span 
class="pxb-x-x-109">_test</span><span 
class="pxb-x-x-109">_net.py </span>we have:
     <ul class="itemize1">
     <li class="itemize"><span 
class="pxi-x-x-109">checkpoint</span><span 
class="pxi-x-x-109">_dir </span>- location of the trained model files
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">useTrain  </span>-  if  true,  calculate  overall  accuracy  on  the  train  set,  else,
     calculate accuracy over the test set
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">mislabeled </span>- map of pairs where the key is a string representing the
     label and an integer representing how many images from that class
     were incorrectly classified
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">inputs </span>- read the tfrecord files and prepare a queue of images batches;
     no need to shuffle the images for testing
     </li>
     <li class="itemize"><span 
class="pxi-x-x-109">test</span><span 
class="pxi-x-x-109">_model </span>- runs the testing process</li></ul>
                                                                    

                                                                    
  <!--l. 1131-->
<div class="lstlisting" id="listing-10"><span class="label"><a 
 id="x1-18311r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">/</span><span 
class="txtt-x-x-109">fruit_test_net</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">py</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18312r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18313r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">numpy</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18314r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensorflow</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18315r5"></a><span 
class="pxr-x-x-60">5</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">numpy</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">np</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18316r6"></a><span 
class="pxr-x-x-60">6</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">os</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18317r7"></a><span 
class="pxr-x-x-60">7</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">re</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18318r8"></a><span 
class="pxr-x-x-60">8</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18319r9"></a><span 
class="pxr-x-x-60">9</span></span><span 
class="txbtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network_structure</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">fruit_network</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18320r10"></a><span 
class="pxr-x-x-60">10</span></span><span 
class="txbtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network_structure</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18321r11"></a><span 
class="pxr-x-x-60">11</span></span><span 
class="txbtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18322r12"></a><span 
class="pxr-x-x-60">12</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18323r13"></a><span 
class="pxr-x-x-60">13</span></span><span 
class="txtt-x-x-109">useTrain</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">False</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18324r14"></a><span 
class="pxr-x-x-60">14</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18325r15"></a><span 
class="pxr-x-x-60">15</span></span><span 
class="txtt-x-x-109">checkpoint_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">os</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">getcwd</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">\\..\\</span><span 
class="txtt-x-x-109">fruit_models</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18326r16"></a><span 
class="pxr-x-x-60">16</span></span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">placeholder</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18327r17"></a><span 
class="pxr-x-x-60">17</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18328r18"></a><span 
class="pxr-x-x-60">18</span></span><span 
class="txbtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">useTrain</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18329r19"></a><span 
class="pxr-x-x-60">19</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images_left_to_process</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">number_train_images</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18330r20"></a><span 
class="pxr-x-x-60">20</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">total_number_of_images</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">number_train_images</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18331r21"></a><span 
class="pxr-x-x-60">21</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">file_name</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18332r22"></a><span 
class="pxr-x-x-60">22</span></span><span 
class="txbtt-x-x-109">else</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18333r23"></a><span 
class="pxr-x-x-60">23</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images_left_to_process</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">number_test_images</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18334r24"></a><span 
class="pxr-x-x-60">24</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">total_number_of_images</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">number_test_images</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18335r25"></a><span 
class="pxr-x-x-60">25</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">file_name</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">test</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18336r26"></a><span 
class="pxr-x-x-60">26</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18337r27"></a><span 
class="pxr-x-x-60">27</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">create</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">a</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">map</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">add</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">each</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">that</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">were</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labeled</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">incorrectly</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18338r28"></a><span 
class="pxr-x-x-60">28</span></span><span 
class="txtt-x-x-109">mislabeled</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">{}</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18339r29"></a><span 
class="pxr-x-x-60">29</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18340r30"></a><span 
class="pxr-x-x-60">30</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">associate</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">number</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">with</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">actual</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">human</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">readable</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18341r31"></a><span 
class="pxr-x-x-60">31</span></span><span 
class="txtt-x-x-109">with</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">open</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">root_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18342r32"></a><span 
class="pxr-x-x-60">32</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels_text</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">readlines</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18343r33"></a><span 
class="pxr-x-x-60">33</span></span><span 
class="txtt-x-x-109">labels_text</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">strip</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels_text</span><span 
class="txtt-x-x-109">]</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18344r34"></a><span 
class="pxr-x-x-60">34</span></span><span 
class="txbtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels_text</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18345r35"></a><span 
class="pxr-x-x-60">35</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">mislabeled</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">]</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18346r36"></a><span 
class="pxr-x-x-60">36</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18347r37"></a><span 
class="pxr-x-x-60">37</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">class</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">is</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">background</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">class</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">so</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">it</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">s</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labeled</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">nothing</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18348r38"></a><span 
class="pxr-x-x-60">38</span></span><span 
class="txtt-x-x-109">labels_text</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">nothing</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">]</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels_text</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18349r39"></a><span 
class="pxr-x-x-60">39</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18350r40"></a><span 
class="pxr-x-x-60">40</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18351r41"></a><span 
class="pxr-x-x-60">41</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">inputs</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">filename</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18352r42"></a><span 
class="pxr-x-x-60">42</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">read_files</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">filename</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18353r43"></a><span 
class="pxr-x-x-60">43</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">adjust_image_for_test</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18354r44"></a><span 
class="pxr-x-x-60">44</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">batch</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18355r45"></a><span 
class="pxr-x-x-60">45</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18356r46"></a><span 
class="pxr-x-x-60">46</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18357r47"></a><span 
class="pxr-x-x-60">47</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">capacity</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">total_number_of_images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18358r48"></a><span 
class="pxr-x-x-60">48</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">allow_smaller_final_batch</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">True</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18359r49"></a><span 
class="pxr-x-x-60">49</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18360r50"></a><span 
class="pxr-x-x-60">50</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18361r51"></a><span 
class="pxr-x-x-60">51</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18362r52"></a><span 
class="pxr-x-x-60">52</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">test_model</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18363r53"></a><span 
class="pxr-x-x-60">53</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">global</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images_left_to_process</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18364r54"></a><span 
class="pxr-x-x-60">54</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">correct</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18365r55"></a><span 
class="pxr-x-x-60">55</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">while</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images_left_to_process</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x003E;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18366r56"></a><span 
class="pxr-x-x-60">56</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_y</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18367r57"></a><span 
class="pxr-x-x-60">57</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_x</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">np</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reshape</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">batch_x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">input_size</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18368r58"></a><span 
class="pxr-x-x-60">58</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">results</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">classification</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">is</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">an</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">array</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">0,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">is</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">a</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">correct</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">classification</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18369r59"></a><span 
class="pxr-x-x-60">59</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">results</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">correct_pred</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">feed_dict</span><span 
class="txtt-x-x-109">={</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_x</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Y</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">batch_y</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1})</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18370r60"></a><span 
class="pxr-x-x-60">60</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images_left_to_process</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x003C;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18371r61"></a><span 
class="pxr-x-x-60">61</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">length</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images_left_to_process</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18372r62"></a><span 
class="pxr-x-x-60">62</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">else</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18373r63"></a><span 
class="pxr-x-x-60">63</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">length</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18374r64"></a><span 
class="pxr-x-x-60">64</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images_left_to_process</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images_left_to_process</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">length</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18375r65"></a><span 
class="pxr-x-x-60">65</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">i</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">range</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">length</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18376r66"></a><span 
class="pxr-x-x-60">66</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">not</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">results</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">i</span><span 
class="txtt-x-x-109">]:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18377r67"></a><span 
class="pxr-x-x-60">67</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">mislabeled</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">labels_text</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">batch_y</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">i</span><span 
class="txtt-x-x-109">]]]</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18378r68"></a><span 
class="pxr-x-x-60">68</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18379r69"></a><span 
class="pxr-x-x-60">69</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">correct</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">correct</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">numpy</span><span 
class="txtt-x-x-109">.</span><span 
class="txbtt-x-x-109">sum</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">results</span><span 
class="txtt-x-x-109">[0:</span><span 
class="txtt-x-x-109">length</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18380r70"></a><span 
class="pxr-x-x-60">70</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">print</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">Predicted</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">d</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">out</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">d</span><span 
class="txtt-x-x-109">;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">partial</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">accuracy</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%.4</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18381r71"></a><span 
class="pxr-x-x-60">71</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">correct</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">total_number_of_images</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images_left_to_process</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">correct</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">/</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">total_number_of_images</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images_left_to_process</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18382r72"></a><span 
class="pxr-x-x-60">72</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">print</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">Final</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">accuracy</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">on</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">s</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">data</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%.8</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">file_name</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">correct</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">/</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">total_number_of_images</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18383r73"></a><span 
class="pxr-x-x-60">73</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18384r74"></a><span 
class="pxr-x-x-60">74</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">build</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18385r75"></a><span 
class="pxr-x-x-60">75</span></span><span 
class="txtt-x-x-109">logits</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">conv_net</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">weights</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">biases</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18386r76"></a><span 
class="pxr-x-x-60">76</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">apply</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">on</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">final</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">layer</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18387r77"></a><span 
class="pxr-x-x-60">77</span></span><span 
class="txtt-x-x-109">prediction</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">logits</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18388r78"></a><span 
class="pxr-x-x-60">78</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18389r79"></a><span 
class="pxr-x-x-60">79</span></span><span 
class="txtt-x-x-109">correct_pred</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">equal</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">argmax</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">prediction</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1)</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Y</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18390r80"></a><span 
class="pxr-x-x-60">80</span></span><span 
class="txtt-x-x-109">accuracy</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reduce_mean</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">cast</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">correct_pred</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18391r81"></a><span 
class="pxr-x-x-60">81</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18392r82"></a><span 
class="pxr-x-x-60">82</span></span><span 
class="txtt-x-x-109">init</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">global_variables_initializer</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18393r83"></a><span 
class="pxr-x-x-60">83</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18394r84"></a><span 
class="pxr-x-x-60">84</span></span><span 
class="txtt-x-x-109">saver</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Saver</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18395r85"></a><span 
class="pxr-x-x-60">85</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18396r86"></a><span 
class="pxr-x-x-60">86</span></span><span 
class="txtt-x-x-109">with</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Session</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18397r87"></a><span 
class="pxr-x-x-60">87</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">init</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18398r88"></a><span 
class="pxr-x-x-60">88</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tfrecords_files</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[(</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">data_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">os</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">listdir</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">data_dir</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">re</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">match</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">file_name</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">]</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18399r89"></a><span 
class="pxr-x-x-60">89</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">inputs</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tfrecords_files</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">batch_size</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18400r90"></a><span 
class="pxr-x-x-60">90</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Coordinator</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18401r91"></a><span 
class="pxr-x-x-60">91</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">threads</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">start_queue_runners</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18402r92"></a><span 
class="pxr-x-x-60">92</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18403r93"></a><span 
class="pxr-x-x-60">93</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">ckpt</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_checkpoint_state</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">checkpoint_dir</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18404r94"></a><span 
class="pxr-x-x-60">94</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saver</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">restore</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">ckpt</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">model_checkpoint_path</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18405r95"></a><span 
class="pxr-x-x-60">95</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">test_model</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18406r96"></a><span 
class="pxr-x-x-60">96</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">print</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">mislabeled</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18407r97"></a><span 
class="pxr-x-x-60">97</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18408r98"></a><span 
class="pxr-x-x-60">98</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">request_stop</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18409r99"></a><span 
class="pxr-x-x-60">99</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">join</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">threads</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18410r100"></a><span 
class="pxr-x-x-60">100</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">close</span><span 
class="txtt-x-x-109">()</span>
  </div>
<!--l. 1236--><p class="indent" >  Finally, we have the <span 
class="pxb-x-x-109">fruit</span><span 
class="pxb-x-x-109">_detection/detect</span><span 
class="pxb-x-x-109">_fruits.py</span>. This serves as a basic
example on how to read an image from a file, resize it and feed it through a
trained model. The script prints the class that had the highest probability after
passing it through the model.
  <!--l. 1239-->
<div class="lstlisting" id="listing-11"><span class="label"><a 
 id="x1-18414r1"></a><span 
class="pxr-x-x-60">1</span></span><span 
class="txtt-x-x-109">fruit_detection</span><span 
class="txtt-x-x-109">/</span><span 
class="txtt-x-x-109">detect_fruits</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">py</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18415r2"></a><span 
class="pxr-x-x-60">2</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18416r3"></a><span 
class="pxr-x-x-60">3</span></span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensorflow</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18417r4"></a><span 
class="pxr-x-x-60">4</span></span><span 
class="txbtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">import</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18418r5"></a><span 
class="pxr-x-x-60">5</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18419r6"></a><span 
class="pxr-x-x-60">6</span></span><span 
class="txtt-x-x-109">with</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">open</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">root_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">utils</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18420r7"></a><span 
class="pxr-x-x-60">7</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">readlines</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18421r8"></a><span 
class="pxr-x-x-60">8</span></span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">strip</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">]</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18422r9"></a><span 
class="pxr-x-x-60">9</span></span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">nothing</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">]</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18423r10"></a><span 
class="pxr-x-x-60">10</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18424r11"></a><span 
class="pxr-x-x-60">11</span></span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">app</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">flags</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">DEFINE_string</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">image_path</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">\\</span><span 
class="txtt-x-x-109">Lemon2</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">jpg</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">Path</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18425r12"></a><span 
class="pxr-x-x-60">12</span></span><span 
class="txtt-x-x-109">FLAGS</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">app</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">flags</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">FLAGS</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18426r13"></a><span 
class="pxr-x-x-60">13</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18427r14"></a><span 
class="pxr-x-x-60">14</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18428r15"></a><span 
class="pxr-x-x-60">15</span></span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">load</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18429r16"></a><span 
class="pxr-x-x-60">16</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">read_image</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image_path</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_reader</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18430r17"></a><span 
class="pxr-x-x-60">17</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">filename_queue</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">string_input_producer</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">image_path</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18431r18"></a><span 
class="pxr-x-x-60">18</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">_</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_file</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_reader</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">read</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">filename_queue</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18432r19"></a><span 
class="pxr-x-x-60">19</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">decode_jpeg</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image_file</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18433r20"></a><span 
class="pxr-x-x-60">20</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">convert_image_dtype</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">local_image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">float32</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18434r21"></a><span 
class="pxr-x-x-60">21</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">gray_image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">rgb_to_grayscale</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">local_image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18435r22"></a><span 
class="pxr-x-x-60">22</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">rgb_to_hsv</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">local_image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18436r23"></a><span 
class="pxr-x-x-60">23</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">shape</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">shape</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">local_image</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18437r24"></a><span 
class="pxr-x-x-60">24</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_height</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">shape</span><span 
class="txtt-x-x-109">[0]</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18438r25"></a><span 
class="pxr-x-x-60">25</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_width</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">shape</span><span 
class="txtt-x-x-109">[1]</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18439r26"></a><span 
class="pxr-x-x-60">26</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_depth</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">shape</span><span 
class="txtt-x-x-109">[2]</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18440r27"></a><span 
class="pxr-x-x-60">27</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reshape</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">local_image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">local_height</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_width</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_depth</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18441r28"></a><span 
class="pxr-x-x-60">28</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">final_image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">concat</span><span 
class="txtt-x-x-109">([</span><span 
class="txtt-x-x-109">local_image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">gray_image</span><span 
class="txtt-x-x-109">],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">2)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18442r29"></a><span 
class="pxr-x-x-60">29</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">final_image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_height</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_width</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">local_depth</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18443r30"></a><span 
class="pxr-x-x-60">30</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18444r31"></a><span 
class="pxr-x-x-60">31</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18445r32"></a><span 
class="pxr-x-x-60">32</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">predict</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18446r33"></a><span 
class="pxr-x-x-60">33</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18447r34"></a><span 
class="pxr-x-x-60">34</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">result</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">running</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">this</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">method</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">is</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">an</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">array</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">probabilities</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">where</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">each</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">index</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">array</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">corresponds</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">a</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">label</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18448r35"></a><span 
class="pxr-x-x-60">35</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">probability</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">feed_dict</span><span 
class="txtt-x-x-109">={</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">images</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1.0})</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18449r36"></a><span 
class="pxr-x-x-60">36</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">get</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">highest</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">probability</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">array</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">that</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">should</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">be</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">result</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18450r37"></a><span 
class="pxr-x-x-60">37</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">prediction</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">argmax</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">probability</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">1)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18451r38"></a><span 
class="pxr-x-x-60">38</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">return</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">prediction</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">probability</span><span 
class="txtt-x-x-109">[0][</span><span 
class="txtt-x-x-109">prediction</span><span 
class="txtt-x-x-109">]</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18452r39"></a><span 
class="pxr-x-x-60">39</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18453r40"></a><span 
class="pxr-x-x-60">40</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18454r41"></a><span 
class="pxr-x-x-60">41</span></span><span 
class="txbtt-x-x-109">def</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">process_image</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_height</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_width</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_depth</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18455r42"></a><span 
class="pxr-x-x-60">42</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_depth</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image_depth</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18456r43"></a><span 
class="pxr-x-x-60">43</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_height</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image_height</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18457r44"></a><span 
class="pxr-x-x-60">44</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_width</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">run</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image_width</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18458r45"></a><span 
class="pxr-x-x-60">45</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">resize</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">100</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">x</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">100</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">pixels</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">shape</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">it</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">be</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">like</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">an</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">array</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">one</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">since</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">that</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">is</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">required</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">input</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18459r46"></a><span 
class="pxr-x-x-60">46</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">for</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">smaller</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">parts</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">an</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">feed</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">those</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">network</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensorflow</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">has</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">a</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">method</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">called</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">extract_image_patches</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18460r47"></a><span 
class="pxr-x-x-60">47</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">img</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">resize_images</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reshape</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[-1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_height</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_width</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_depth</span><span 
class="txtt-x-x-109">])</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[100,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">100])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18461r48"></a><span 
class="pxr-x-x-60">48</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">img</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">reshape</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">img</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">[-1,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">100</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">*</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">100</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">*</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">4])</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18462r49"></a><span 
class="pxr-x-x-60">49</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">rez</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">prob</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">predict</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">img</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18463r50"></a><span 
class="pxr-x-x-60">50</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txbtt-x-x-109">print</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">Label</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">index</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">d</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">Label</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">s</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">-</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">Probability</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%.4</span><span 
class="txtt-x-x-109">f</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">%</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">rez</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">labels</span><span 
class="txtt-x-x-109">[</span><span 
class="txtt-x-x-109">rez</span><span 
class="txtt-x-x-109">[0]],</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">prob</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18464r51"></a><span 
class="pxr-x-x-60">51</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18465r52"></a><span 
class="pxr-x-x-60">52</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18466r53"></a><span 
class="pxr-x-x-60">53</span></span><span 
class="txtt-x-x-109">with</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Session</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">:</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18467r54"></a><span 
class="pxr-x-x-60">54</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_path</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">FLAGS</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">image_path</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18468r55"></a><span 
class="pxr-x-x-60">55</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_reader</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">WholeFileReader</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18469r56"></a><span 
class="pxr-x-x-60">56</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18470r57"></a><span 
class="pxr-x-x-60">57</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">restore</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">trained</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">model</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saved</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">checkpoint</span><span 
class="txtt-x-x-109">;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">provide</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">path</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">meta</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">file</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18471r58"></a><span 
class="pxr-x-x-60">58</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saver</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">import_meta_graph</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">fruit_models_dir</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">+</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">model</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">ckpt</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">meta</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18472r59"></a><span 
class="pxr-x-x-60">59</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">provide</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">path</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">folder</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">containing</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">checkpoints</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18473r60"></a><span 
class="pxr-x-x-60">60</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saver</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">restore</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">latest_checkpoint</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">constants</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">fruit_models_dir</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18474r61"></a><span 
class="pxr-x-x-60">61</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">graph</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_default_graph</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18475r62"></a><span 
class="pxr-x-x-60">62</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18476r63"></a><span 
class="pxr-x-x-60">63</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">obtain</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">a</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensor</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">from</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saved</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">model</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">we</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">must</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">get</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">it</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">by</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">which</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">is</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">why</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">we</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensors</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">when</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">we</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">create</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">them</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18477r64"></a><span 
class="pxr-x-x-60">64</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">even</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">if</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">there</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">is</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">only</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">one</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensor</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">with</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">a</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">meta</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">checkpoint</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">files</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">it</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">is</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">saved</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">as</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">an</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">array</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">so</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">we</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">have</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">provide</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">index</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18478r65"></a><span 
class="pxr-x-x-60">65</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensor</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">that</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">we</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">want</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">get</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">-&#x003E;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">thus</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">we</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">call</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">get_tensor_by_name</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">tensor_name</span><span 
class="txtt-x-x-109">:0)</span><span 
class="txtt-x-x-109">&#8221;</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18479r66"></a><span 
class="pxr-x-x-60">66</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18480r67"></a><span 
class="pxr-x-x-60">67</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">obtain</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">input</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensor</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">by</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18481r68"></a><span 
class="pxr-x-x-60">68</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">graph</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_tensor_by_name</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">:0</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18482r69"></a><span 
class="pxr-x-x-60">69</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">obtain</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tensor</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18483r70"></a><span 
class="pxr-x-x-60">70</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">graph</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_tensor_by_name</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">:0</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18484r71"></a><span 
class="pxr-x-x-60">71</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">#</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">obtain</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">the</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">output</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">layer</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">by</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">name</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">and</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">apply</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">on</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">in</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">order</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">to</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">obtain</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">an</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">output</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">of</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">probabilities</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18485r72"></a><span 
class="pxr-x-x-60">72</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">nn</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">graph</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">get_tensor_by_name</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">:0</span><span 
class="txtt-x-x-109">&#8217;</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18486r73"></a><span 
class="pxr-x-x-60">73</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18487r74"></a><span 
class="pxr-x-x-60">74</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">height</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">width</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">depth</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">read_image</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">image_path</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image_reader</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18488r75"></a><span 
class="pxr-x-x-60">75</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">Coordinator</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18489r76"></a><span 
class="pxr-x-x-60">76</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">threads</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">tf</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">train</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">start_queue_runners</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">=</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18490r77"></a><span 
class="pxr-x-x-60">77</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">process_image</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">X</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">softmax</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">keep_prob</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">image</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">height</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">width</span><span 
class="txtt-x-x-109">,</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">depth</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18491r78"></a><span 
class="pxr-x-x-60">78</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18492r79"></a><span 
class="pxr-x-x-60">79</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">request_stop</span><span 
class="txtt-x-x-109">()</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18493r80"></a><span 
class="pxr-x-x-60">80</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">coord</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">join</span><span 
class="txtt-x-x-109">(</span><span 
class="txtt-x-x-109">threads</span><span 
class="txtt-x-x-109">)</span><span 
class="txtt-x-x-109">&#x00A0;</span><br /><span class="label"><a 
 id="x1-18494r81"></a><span 
class="pxr-x-x-60">81</span></span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">&#x00A0;</span><span 
class="txtt-x-x-109">sess</span><span 
class="txtt-x-x-109">.</span><span 
class="txtt-x-x-109">close</span><span 
class="txtt-x-x-109">()</span>
  </div>
<!--l. 1324--><p class="indent" >
                                                                    

                                                                    
  <h3 class="likesectionHead"><a 
 id="x1-190008"></a>References</h3>
<!--l. 1--><p class="noindent" >
     <div class="thebibliography">
     <p class="bibitem" ><span class="biblabel">
  [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xorchards"></a><span 
class="pxsc-x-x-109">B<span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">G</span><span 
class="small-caps">O</span><span 
class="small-caps">T</span><span 
class="small-caps">I</span>, S., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> U<span 
class="small-caps">N</span><span 
class="small-caps">D</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span><span 
class="small-caps">W</span><span 
class="small-caps">O</span><span 
class="small-caps">O</span><span 
class="small-caps">D</span>, J.  </span>Deep fruit detection in orchards.
     In <span 
class="pxi-x-x-109">2017 IEEE International Conference on Robotics and Automation (ICRA)</span>
     (May 2017), pp.&#x00A0;3626&#8211;3633.  <span id="textcolor1"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
  [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xdata_synthesis"></a><span 
class="pxsc-x-x-109">B<span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">T</span><span 
class="small-caps">H</span>,   R.,   IJ<span 
class="small-caps">S</span><span 
class="small-caps">S</span><span 
class="small-caps">E</span><span 
class="small-caps">L</span><span 
class="small-caps">M</span><span 
class="small-caps">U</span><span 
class="small-caps">I</span><span 
class="small-caps">D</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span>,   J.,   H<span 
class="small-caps">E</span><span 
class="small-caps">M</span><span 
class="small-caps">M</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span>,   J.,   <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>   H<span 
class="small-caps">E</span><span 
class="small-caps">N</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span>,   E.</span><span 
class="pxsc-x-x-109">&#x00A0;V.</span>
     Data synthesis methods for semantic segmentation in agriculture: A
     capsicum annuum dataset. <span 
class="pxi-x-x-109">Computers and Electronics in Agriculture 144</span>
     (2018), 284 &#8211; 296.  <span id="textcolor2"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
  [3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xchan"></a><span 
class="pxsc-x-x-109">C<span 
class="small-caps">H</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>, T.</span><span 
class="pxsc-x-x-109">&#x00A0;F., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> V<span 
class="small-caps">E</span><span 
class="small-caps">S</span><span 
class="small-caps">E</span>, L.</span><span 
class="pxsc-x-x-109">&#x00A0;A. </span>Active contours without edges. <span 
class="pxi-x-x-109">IEEE</span>
     <span 
class="pxi-x-x-109">Transactions on Image Processing 10</span>, 2 (Feb 2001), 266&#8211;277.  <span id="textcolor3"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
  [4]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xyield_prediction"></a><span 
class="pxsc-x-x-109">C<span 
class="small-caps">H</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span>,  H.,  D<span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span><span 
class="small-caps">O</span><span 
class="small-caps">W</span>,  L.,  S<span 
class="small-caps">U</span><span 
class="small-caps">N</span>,  Y.,  <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>  B<span 
class="small-caps">L</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">K</span><span 
class="small-caps">E</span>,  M.   </span>Early  yield
     prediction using image analysis of apple fruit and tree canopy features
     with neural networks. <span 
class="pxi-x-x-109">Journal of Imaging 3</span>, 1 (2017).  <span id="textcolor4"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
  [5]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsuperhuman_network"></a><span 
class="pxsc-x-x-109">C<span 
class="small-caps">I</span><span 
class="small-caps">R</span><span 
class="small-caps">E</span></span><span 
class="pxsc-x-x-109">&#351;<span 
class="small-caps">A</span><span 
class="small-caps">N</span>,     D.</span><span 
class="pxsc-x-x-109">&#x00A0;C.,     G<span 
class="small-caps">I</span><span 
class="small-caps">U</span><span 
class="small-caps">S</span><span 
class="small-caps">T</span><span 
class="small-caps">I</span>,     A.,     G<span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">B</span><span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">D</span><span 
class="small-caps">E</span><span 
class="small-caps">L</span><span 
class="small-caps">L</span><span 
class="small-caps">A</span>,     L.</span><span 
class="pxsc-x-x-109">&#x00A0;M.,     <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span></span>
     <span 
class="pxsc-x-x-109">S<span 
class="small-caps">C</span><span 
class="small-caps">H</span><span 
class="small-caps">M</span><span 
class="small-caps">I</span><span 
class="small-caps">D</span><span 
class="small-caps">H</span><span 
class="small-caps">U</span><span 
class="small-caps">B</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>, J. </span>Deep neural networks segment neuronal membranes
     in electron microscopy images.  In <span 
class="pxi-x-x-109">Proceedings of the 25th International</span>
     <span 
class="pxi-x-x-109">Conference on Neural Information Processing Systems - Volume 2 </span>(USA,
     2012), NIPS&#8217;12, Curran Associates Inc., pp.&#x00A0;2843&#8211;2851.  <span id="textcolor5"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
  [6]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xhigh_perf_conv"></a><span 
class="pxsc-x-x-109">C<span 
class="small-caps">I</span><span 
class="small-caps">R</span><span 
class="small-caps">E</span></span><span 
class="pxsc-x-x-109">&#351;<span 
class="small-caps">A</span><span 
class="small-caps">N</span>,  D.</span><span 
class="pxsc-x-x-109">&#x00A0;C.,  M<span 
class="small-caps">E</span><span 
class="small-caps">I</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>,  U.,  M<span 
class="small-caps">A</span><span 
class="small-caps">S</span><span 
class="small-caps">C</span><span 
class="small-caps">I</span>,  J.,  G<span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">B</span><span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">D</span><span 
class="small-caps">E</span><span 
class="small-caps">L</span><span 
class="small-caps">L</span><span 
class="small-caps">A</span>,  L.</span><span 
class="pxsc-x-x-109">&#x00A0;M.,  <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span></span>
     <span 
class="pxsc-x-x-109">S<span 
class="small-caps">C</span><span 
class="small-caps">H</span><span 
class="small-caps">M</span><span 
class="small-caps">I</span><span 
class="small-caps">D</span><span 
class="small-caps">H</span><span 
class="small-caps">U</span><span 
class="small-caps">B</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>,  J.    </span>Flexible,  high  performance  convolutional  neural
     networks for image classification.  In <span 
class="pxi-x-x-109">Proceedings of the Twenty-Second</span>
     <span 
class="pxi-x-x-109">International Joint Conference on Artificial Intelligence - Volume Volume</span>
     <span 
class="pxi-x-x-109">Two </span>(2011), IJCAI&#8217;11, AAAI Press, pp.&#x00A0;1237&#8211;1242.  <span id="textcolor6"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
                                                                    

                                                                    
     <p class="bibitem" ><span class="biblabel">
  [7]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xmulti_column"></a><span 
class="pxsc-x-x-109">C<span 
class="small-caps">I</span><span 
class="small-caps">R</span><span 
class="small-caps">E</span><span 
class="small-caps">S</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>, D.</span><span 
class="pxsc-x-x-109">&#x00A0;C., M<span 
class="small-caps">E</span><span 
class="small-caps">I</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>, U., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> S<span 
class="small-caps">C</span><span 
class="small-caps">H</span><span 
class="small-caps">M</span><span 
class="small-caps">I</span><span 
class="small-caps">D</span><span 
class="small-caps">H</span><span 
class="small-caps">U</span><span 
class="small-caps">B</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>, J. </span>Multi-column deep
     neural networks for image classification.  <span 
class="pxi-x-x-109">CoRR abs/1202.2745 </span>(2012).
     <span id="textcolor7"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
  [8]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xelu"></a><span 
class="pxsc-x-x-109">C<span 
class="small-caps">L</span><span 
class="small-caps">E</span><span 
class="small-caps">V</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span><span 
class="small-caps">T</span>, D., U<span 
class="small-caps">N</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span><span 
class="small-caps">T</span><span 
class="small-caps">H</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>, T., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> H<span 
class="small-caps">O</span><span 
class="small-caps">C</span><span 
class="small-caps">H</span><span 
class="small-caps">R</span><span 
class="small-caps">E</span><span 
class="small-caps">I</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>, S. </span>Fast and accurate
     deep  network  learning  by  exponential  linear  units  (elus).    <span 
class="pxi-x-x-109">CoRR</span>
     <span 
class="pxi-x-x-109">abs/1511.07289 </span>(2015).  <span id="textcolor8"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
  [9]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xdeep_speech"></a><span 
class="pxsc-x-x-109">H<span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">N</span><span 
class="small-caps">U</span><span 
class="small-caps">N</span>, A.</span><span 
class="pxsc-x-x-109">&#x00A0;Y., C<span 
class="small-caps">A</span><span 
class="small-caps">S</span><span 
class="small-caps">E</span>, C., C<span 
class="small-caps">A</span><span 
class="small-caps">S</span><span 
class="small-caps">P</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>, J., C<span 
class="small-caps">A</span><span 
class="small-caps">T</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">Z</span><span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">O</span>, B., D<span 
class="small-caps">I</span><span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">O</span><span 
class="small-caps">S</span>, G.,</span>
     <span 
class="pxsc-x-x-109">E<span 
class="small-caps">L</span><span 
class="small-caps">S</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span>, E., P<span 
class="small-caps">R</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>, R., S<span 
class="small-caps">A</span><span 
class="small-caps">T</span><span 
class="small-caps">H</span><span 
class="small-caps">E</span><span 
class="small-caps">E</span><span 
class="small-caps">S</span><span 
class="small-caps">H</span>, S., S<span 
class="small-caps">E</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">U</span><span 
class="small-caps">P</span><span 
class="small-caps">T</span><span 
class="small-caps">A</span>, S., C<span 
class="small-caps">O</span><span 
class="small-caps">A</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">S</span>, A., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> N<span 
class="small-caps">G</span>,</span>
     <span 
class="pxsc-x-x-109">A.</span><span 
class="pxsc-x-x-109">&#x00A0;Y.  </span>Deep speech: Scaling up end-to-end speech recognition.  <span 
class="pxi-x-x-109">CoRR</span>
     <span 
class="pxi-x-x-109">abs/1412.5567 </span>(2014).  <span id="textcolor9"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [10]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xcamera_angles"></a><span 
class="pxsc-x-x-109">H<span 
class="small-caps">E</span><span 
class="small-caps">M</span><span 
class="small-caps">M</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span>,  J.,  R<span 
class="small-caps">U</span><span 
class="small-caps">I</span><span 
class="small-caps">Z</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span><span 
class="small-caps">A</span><span 
class="small-caps">A</span><span 
class="small-caps">L</span>,  J.,  H<span 
class="small-caps">O</span><span 
class="small-caps">F</span><span 
class="small-caps">S</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">E</span>,  J.</span><span 
class="pxsc-x-x-109">&#x00A0;W.,  <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>  <span 
class="small-caps">V</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>  H<span 
class="small-caps">E</span><span 
class="small-caps">N</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span>,</span>
     <span 
class="pxsc-x-x-109">E.</span><span 
class="pxsc-x-x-109">&#x00A0;J.    </span>Fruit  detectability  analysis  for  different  camera  positions  in
     sweet-pepper. <span 
class="pxi-x-x-109">Sensors 14</span>, 4 (2014), 6032&#8211;6044.  <span id="textcolor10"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [11]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xrobot_harvest"></a><span 
class="pxsc-x-x-109">K<span 
class="small-caps">A</span><span 
class="small-caps">P</span><span 
class="small-caps">A</span><span 
class="small-caps">C</span><span 
class="small-caps">H</span>, K., B<span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">N</span><span 
class="small-caps">E</span><span 
class="small-caps">A</span>, E., M<span 
class="small-caps">A</span><span 
class="small-caps">I</span><span 
class="small-caps">R</span><span 
class="small-caps">O</span><span 
class="small-caps">N</span>, R., E<span 
class="small-caps">D</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>, Y., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> B<span 
class="small-caps">E</span><span 
class="small-caps">N</span>-S<span 
class="small-caps">H</span><span 
class="small-caps">A</span><span 
class="small-caps">H</span><span 
class="small-caps">A</span><span 
class="small-caps">R</span>, O.</span>
     Computer vision for fruit harvesting robots &amp;#150; state of the art and
     challenges ahead.  <span 
class="pxi-x-x-109">Int. J. Comput. Vision Robot. 3</span>, 1/2 (Apr. 2012), 4&#8211;34.
     <span id="textcolor11"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [12]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xcifar"></a><span 
class="pxsc-x-x-109">K<span 
class="small-caps">R</span><span 
class="small-caps">I</span><span 
class="small-caps">Z</span><span 
class="small-caps">H</span><span 
class="small-caps">E</span><span 
class="small-caps">V</span><span 
class="small-caps">S</span><span 
class="small-caps">K</span><span 
class="small-caps">Y</span>, A., N<span 
class="small-caps">A</span><span 
class="small-caps">I</span><span 
class="small-caps">R</span>, V., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> H<span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">T</span><span 
class="small-caps">O</span><span 
class="small-caps">N</span>, G. </span>The cifar dataset. [Online;
     accessed 27.10.2018].  <span id="textcolor12"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [13]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xmnist"></a><span 
class="pxsc-x-x-109">L<span 
class="small-caps">E</span>C<span 
class="small-caps">U</span><span 
class="small-caps">N</span>, Y., C<span 
class="small-caps">O</span><span 
class="small-caps">R</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">S</span>, C., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> B<span 
class="small-caps">U</span><span 
class="small-caps">R</span><span 
class="small-caps">G</span><span 
class="small-caps">E</span><span 
class="small-caps">S</span>, C.</span><span 
class="pxsc-x-x-109">&#x00A0;J.   </span>The mnist database of
     handwritten digits. [Online; accessed 27.10.2018].  <span id="textcolor13"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [14]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xdeep_belief"></a><span 
class="pxsc-x-x-109">L<span 
class="small-caps">E</span><span 
class="small-caps">E</span>, H., G<span 
class="small-caps">R</span><span 
class="small-caps">O</span><span 
class="small-caps">S</span><span 
class="small-caps">S</span><span 
class="small-caps">E</span>, R., R<span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">A</span><span 
class="small-caps">T</span><span 
class="small-caps">H</span>, R., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> N<span 
class="small-caps">G</span>, A.</span><span 
class="pxsc-x-x-109">&#x00A0;Y.  </span>Convolutional
     deep belief networks for scalable unsupervised learning of hierarchical
                                                                    

                                                                    
     representations.      In   <span 
class="pxi-x-x-109">Proceedings   of   the   26th   Annual   International</span>
     <span 
class="pxi-x-x-109">Conference on Machine Learning </span>(New York, NY, USA, 2009), ICML &#8217;09,
     ACM, pp.&#x00A0;609&#8211;616.  <span id="textcolor14"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [15]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xcucumber"></a><span 
class="pxsc-x-x-109">L<span 
class="small-caps">I</span>, D., Z<span 
class="small-caps">H</span><span 
class="small-caps">A</span><span 
class="small-caps">O</span>, H., Z<span 
class="small-caps">H</span><span 
class="small-caps">A</span><span 
class="small-caps">O</span>, X., G<span 
class="small-caps">A</span><span 
class="small-caps">O</span>, Q., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> X<span 
class="small-caps">U</span>, L. </span>Cucumber detection
     based  on  texture  and  color  in  greenhouse.    <span 
class="pxi-x-x-109">International  Journal  of</span>
     <span 
class="pxi-x-x-109">Pattern Recognition and Artificial Intelligence 31 </span>(01 2017).  <span id="textcolor15"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [16]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xrecurrent_conv"></a><span 
class="pxsc-x-x-109">L<span 
class="small-caps">I</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span>, M., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> H<span 
class="small-caps">U</span>, X.   </span>Recurrent convolutional neural network
     for object recognition.  In <span 
class="pxi-x-x-109">2015 IEEE Conference on Computer Vision and</span>
     <span 
class="pxi-x-x-109">Pattern Recognition (CVPR) </span>(June 2015), pp.&#x00A0;3367&#8211;3375.  <span id="textcolor16"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [17]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xmumford"></a><span 
class="pxsc-x-x-109">M<span 
class="small-caps">U</span><span 
class="small-caps">M</span><span 
class="small-caps">F</span><span 
class="small-caps">O</span><span 
class="small-caps">R</span><span 
class="small-caps">D</span>,   D.,   <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>   S<span 
class="small-caps">H</span><span 
class="small-caps">A</span><span 
class="small-caps">H</span>,   J.       </span>Optimal   approximations   by
     piecewise  smooth  functions  and  associated  variational  problems.
     <span 
class="pxi-x-x-109">Communications on Pure and Applied Mathematics 42</span>, 5 (1989), 577&#8211;685.
     <span id="textcolor17"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [18]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xfruits_360_github"></a><span 
class="pxsc-x-x-109">M<span 
class="small-caps">U</span><span 
class="small-caps">R</span><span 
class="small-caps">E</span><span 
class="small-caps">S</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>, H., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> O<span 
class="small-caps">L</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>, M. </span>Fruits 360 dataset on github. [Online;
     accessed 27.10.2018].  <span id="textcolor18"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [19]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xfruits_360_kaggle"></a><span 
class="pxsc-x-x-109">M<span 
class="small-caps">U</span><span 
class="small-caps">R</span><span 
class="small-caps">E</span><span 
class="small-caps">S</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>, H., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> O<span 
class="small-caps">L</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>, M. </span>Fruits 360 dataset on kaggle. [Online;
     accessed 27.10.2018].  <span id="textcolor19"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [20]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xk_nearest_fruits"></a><span 
class="pxsc-x-x-109">N<span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">A</span><span 
class="small-caps">W</span><span 
class="small-caps">E</span>, P., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> P<span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span><span 
class="small-caps">E</span><span 
class="small-caps">Y</span>, M.</span><span 
class="pxsc-x-x-109">&#x00A0;S.  </span>A completion on fruit recognition
     system using k-nearest neighbors algorithm.  In <span 
class="pxi-x-x-109">International Journal</span>
     <span 
class="pxi-x-x-109">of Advanced Research in Computer Engineering &amp; Technology (IJARCET)</span>
     (2014), vol.&#x00A0;3.  <span id="textcolor20"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [21]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xlens"></a><span 
class="pxsc-x-x-109">O&#8217;B<span 
class="small-caps">O</span><span 
class="small-caps">Y</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span>, B., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> H<span 
class="small-caps">A</span><span 
class="small-caps">L</span><span 
class="small-caps">L</span>, C. </span>What is google lens and how do you use
     it? [Online; accessed 05.05.2018].  <span id="textcolor21"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
                                                                    

                                                                    
     <p class="bibitem" ><span class="biblabel">
 [22]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xauto_harvest"></a><span 
class="pxsc-x-x-109">P<span 
class="small-caps">U</span><span 
class="small-caps">T</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span><span 
class="small-caps">M</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">S</span>,   S.,   V<span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">B</span><span 
class="small-caps">R</span><span 
class="small-caps">A</span><span 
class="small-caps">B</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">T</span>,   Y.,   T<span 
class="small-caps">I</span><span 
class="small-caps">T</span><span 
class="small-caps">S</span>,   L.,   <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>   G<span 
class="small-caps">O</span><span 
class="small-caps">E</span><span 
class="small-caps">D</span><span 
class="small-caps">E</span><span 
class="small-caps">M</span></span><span 
class="pxsc-x-x-109">,   T.</span>
     Automated visual fruit detection for harvest estimation and robotic
     harvesting.  In <span 
class="pxi-x-x-109">2016 Sixth International Conference on Image Processing</span>
     <span 
class="pxi-x-x-109">Theory, Tools and Applications (IPTA) </span>(Dec 2016), pp.&#x00A0;1&#8211;6.  <span id="textcolor22"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [23]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xfruit_count"></a><span 
class="pxsc-x-x-109">R<span 
class="small-caps">A</span><span 
class="small-caps">H</span><span 
class="small-caps">N</span><span 
class="small-caps">E</span><span 
class="small-caps">M</span><span 
class="small-caps">O</span><span 
class="small-caps">O</span><span 
class="small-caps">N</span><span 
class="small-caps">F</span><span 
class="small-caps">A</span><span 
class="small-caps">R</span>, M., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> S<span 
class="small-caps">H</span><span 
class="small-caps">E</span><span 
class="small-caps">P</span><span 
class="small-caps">P</span><span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">D</span>, C.  </span>Deep count: Fruit counting
     based on deep simulated learning. <span 
class="pxi-x-x-109">Sensors 17</span>, 4 (2017).  <span id="textcolor23"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [24]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xrcnn"></a><span 
class="pxsc-x-x-109">R<span 
class="small-caps">E</span><span 
class="small-caps">N</span>,  S.,  H<span 
class="small-caps">E</span>,  K.,  G<span 
class="small-caps">I</span><span 
class="small-caps">R</span><span 
class="small-caps">S</span><span 
class="small-caps">H</span><span 
class="small-caps">I</span><span 
class="small-caps">C</span><span 
class="small-caps">K</span>,  R.</span><span 
class="pxsc-x-x-109">&#x00A0;B.,  <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>  S<span 
class="small-caps">U</span><span 
class="small-caps">N</span>,  J.    </span>Faster  R-CNN:
     towards  real-time  object  detection  with  region  proposal  networks.
     <span 
class="pxi-x-x-109">CoRR abs/1506.01497 </span>(2015).  <span id="textcolor24"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [25]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xdeep_fruits"></a><span 
class="pxsc-x-x-109">S<span 
class="small-caps">A</span>,  I.,  G<span 
class="small-caps">E</span>,  Z.,  D<span 
class="small-caps">A</span><span 
class="small-caps">Y</span><span 
class="small-caps">O</span><span 
class="small-caps">U</span><span 
class="small-caps">B</span>,  F.,  U<span 
class="small-caps">P</span><span 
class="small-caps">C</span><span 
class="small-caps">R</span><span 
class="small-caps">O</span><span 
class="small-caps">F</span><span 
class="small-caps">T</span>,  B.,  P<span 
class="small-caps">E</span><span 
class="small-caps">R</span><span 
class="small-caps">E</span><span 
class="small-caps">Z</span>,  T.,  <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>  M<span 
class="small-caps">C</span>C<span 
class="small-caps">O</span><span 
class="small-caps">O</span><span 
class="small-caps">L</span>,</span>
     <span 
class="pxsc-x-x-109">C.  </span>Deepfruits: A fruit detection system using deep neural networks.
     <span 
class="pxi-x-x-109">Sensors 16</span>, 8 (2016).  <span id="textcolor25"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [26]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xoverview"></a><span 
class="pxsc-x-x-109">S<span 
class="small-caps">C</span><span 
class="small-caps">H</span><span 
class="small-caps">M</span><span 
class="small-caps">I</span><span 
class="small-caps">D</span><span 
class="small-caps">H</span><span 
class="small-caps">U</span><span 
class="small-caps">B</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>, J.  </span>Deep learning in neural networks: An overview.
     <span 
class="pxi-x-x-109">CoRR abs/1404.7828 </span>(2014).  <span id="textcolor26"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [27]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xcolor_texture"></a><span 
class="pxsc-x-x-109">S<span 
class="small-caps">E</span><span 
class="small-caps">L</span><span 
class="small-caps">V</span><span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">A</span><span 
class="small-caps">J</span>,  A.,  S<span 
class="small-caps">H</span><span 
class="small-caps">E</span><span 
class="small-caps">B</span><span 
class="small-caps">I</span><span 
class="small-caps">A</span><span 
class="small-caps">H</span>,  N.,  N<span 
class="small-caps">I</span><span 
class="small-caps">D</span><span 
class="small-caps">H</span><span 
class="small-caps">Y</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">T</span><span 
class="small-caps">H</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>,  S.,  <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>  G<span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">E</span><span 
class="small-caps">S</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>,  L.</span>
     Fruit recognition using color and texture features.  <span 
class="pxi-x-x-109">Journal of Emerging</span>
     <span 
class="pxi-x-x-109">Trends in Computing and Information Sciences 1 </span>(10 2010), 90&#8211;94.  <span id="textcolor27"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [28]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xauto_counting"></a><span 
class="pxsc-x-x-109">S<span 
class="small-caps">O</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span>, Y., G<span 
class="small-caps">L</span><span 
class="small-caps">A</span><span 
class="small-caps">S</span><span 
class="small-caps">B</span><span 
class="small-caps">E</span><span 
class="small-caps">Y</span>, C., H<span 
class="small-caps">O</span><span 
class="small-caps">R</span><span 
class="small-caps">G</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>, G., P<span 
class="small-caps">O</span><span 
class="small-caps">L</span><span 
class="small-caps">D</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>, G., D<span 
class="small-caps">I</span><span 
class="small-caps">E</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span><span 
class="small-caps">M</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>, J., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span></span>
     <span 
class="pxsc-x-x-109"><span 
class="small-caps">V</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span></span><span 
class="pxsc-x-x-109">&#x00A0;<span 
class="small-caps">D</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span> H<span 
class="small-caps">E</span><span 
class="small-caps">I</span><span 
class="small-caps">J</span><span 
class="small-caps">D</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span>, G.  </span>Automatic fruit recognition and counting from
     multiple images. <span 
class="pxi-x-x-109">Biosystems Engineering 118 </span>(2014), 203 &#8211; 215.  <span id="textcolor28"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [29]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xall_conv"></a><span 
class="pxsc-x-x-109">S<span 
class="small-caps">P</span><span 
class="small-caps">R</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span><span 
class="small-caps">B</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span><span 
class="small-caps">G</span>,  J.</span><span 
class="pxsc-x-x-109">&#x00A0;T.,  D<span 
class="small-caps">O</span><span 
class="small-caps">S</span><span 
class="small-caps">O</span><span 
class="small-caps">V</span><span 
class="small-caps">I</span><span 
class="small-caps">T</span><span 
class="small-caps">S</span><span 
class="small-caps">K</span><span 
class="small-caps">I</span><span 
class="small-caps">Y</span>,  A.,  B<span 
class="small-caps">R</span><span 
class="small-caps">O</span><span 
class="small-caps">X</span>,  T.,  <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>  R<span 
class="small-caps">I</span><span 
class="small-caps">E</span><span 
class="small-caps">D</span><span 
class="small-caps">M</span><span 
class="small-caps">I</span><span 
class="small-caps">L</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>,</span>
     <span 
class="pxsc-x-x-109">M.</span><span 
class="pxsc-x-x-109">&#x00A0;A.    </span>Striving  for  simplicity:  The  all  convolutional  net.    <span 
class="pxi-x-x-109">CoRR</span>
     <span 
class="pxi-x-x-109">abs/1412.6806 </span>(2014).  <span id="textcolor29"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
                                                                    

                                                                    
     </p>
     <p class="bibitem" ><span class="biblabel">
 [30]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xvery_deep"></a><span 
class="pxsc-x-x-109">S<span 
class="small-caps">R</span><span 
class="small-caps">I</span><span 
class="small-caps">V</span><span 
class="small-caps">A</span><span 
class="small-caps">S</span><span 
class="small-caps">T</span><span 
class="small-caps">A</span><span 
class="small-caps">V</span><span 
class="small-caps">A</span>, R.</span><span 
class="pxsc-x-x-109">&#x00A0;K., G<span 
class="small-caps">R</span><span 
class="small-caps">E</span><span 
class="small-caps">F</span><span 
class="small-caps">F</span>, K., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> S<span 
class="small-caps">C</span><span 
class="small-caps">H</span><span 
class="small-caps">M</span><span 
class="small-caps">I</span><span 
class="small-caps">D</span><span 
class="small-caps">H</span><span 
class="small-caps">U</span><span 
class="small-caps">B</span><span 
class="small-caps">E</span><span 
class="small-caps">R</span>, J.   </span>Training very
     deep networks. <span 
class="pxi-x-x-109">CoRR abs/1507.06228 </span>(2015).  <span id="textcolor30"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [31]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xinception"></a><span 
class="pxsc-x-x-109">S<span 
class="small-caps">Z</span><span 
class="small-caps">E</span><span 
class="small-caps">G</span><span 
class="small-caps">E</span><span 
class="small-caps">D</span><span 
class="small-caps">Y</span>, C., L<span 
class="small-caps">I</span><span 
class="small-caps">U</span>, W., J<span 
class="small-caps">I</span><span 
class="small-caps">A</span>, Y., S<span 
class="small-caps">E</span><span 
class="small-caps">R</span><span 
class="small-caps">M</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">E</span><span 
class="small-caps">T</span>, P., R<span 
class="small-caps">E</span><span 
class="small-caps">E</span><span 
class="small-caps">D</span>, S.</span><span 
class="pxsc-x-x-109">&#x00A0;E., A<span 
class="small-caps">N</span><span 
class="small-caps">G</span><span 
class="small-caps">U</span><span 
class="small-caps">E</span><span 
class="small-caps">L</span><span 
class="small-caps">O</span><span 
class="small-caps">V</span>,</span>
     <span 
class="pxsc-x-x-109">D., E<span 
class="small-caps">R</span><span 
class="small-caps">H</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>, D., V<span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">H</span><span 
class="small-caps">O</span><span 
class="small-caps">U</span><span 
class="small-caps">C</span><span 
class="small-caps">K</span><span 
class="small-caps">E</span>, V., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> R<span 
class="small-caps">A</span><span 
class="small-caps">B</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">O</span><span 
class="small-caps">V</span><span 
class="small-caps">I</span><span 
class="small-caps">C</span><span 
class="small-caps">H</span>, A. </span>Going deeper with
     convolutions. <span 
class="pxi-x-x-109">CoRR abs/1409.4842 </span>(2014).  <span id="textcolor31"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [32]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xtf"></a><span 
class="pxsc-x-x-109">T<span 
class="small-caps">E</span><span 
class="small-caps">N</span><span 
class="small-caps">S</span><span 
class="small-caps">O</span><span 
class="small-caps">R</span>F<span 
class="small-caps">L</span><span 
class="small-caps">O</span><span 
class="small-caps">W</span></span>. Tensorflow. [Online; accessed 05.05.2018].  <span id="textcolor32"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [33]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xconv"></a><span 
class="pxsc-x-x-109">W<span 
class="small-caps">I</span><span 
class="small-caps">K</span><span 
class="small-caps">I</span><span 
class="small-caps">P</span><span 
class="small-caps">E</span><span 
class="small-caps">D</span><span 
class="small-caps">I</span><span 
class="small-caps">A</span></span>.     Convolution  in  mathematics.     [Online;  accessed
     05.05.2018].  <span id="textcolor33"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [34]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xdl"></a><span 
class="pxsc-x-x-109">W<span 
class="small-caps">I</span><span 
class="small-caps">K</span><span 
class="small-caps">I</span><span 
class="small-caps">P</span><span 
class="small-caps">E</span><span 
class="small-caps">D</span><span 
class="small-caps">I</span><span 
class="small-caps">A</span></span>.  Deep learning article on wikipedia.  [Online; accessed
     05.05.2018].  <span id="textcolor34"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [35]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xgoogle_lens_wikipedia"></a><span 
class="pxsc-x-x-109">W<span 
class="small-caps">I</span><span 
class="small-caps">K</span><span 
class="small-caps">I</span><span 
class="small-caps">P</span><span 
class="small-caps">E</span><span 
class="small-caps">D</span><span 
class="small-caps">I</span><span 
class="small-caps">A</span></span>.      Google   lens   on   wikipedia.      [Online;   accessed
     05.05.2018].  <span id="textcolor35"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [36]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xgreen_grape"></a><span 
class="pxsc-x-x-109">X<span 
class="small-caps">I</span><span 
class="small-caps">O</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span>, J., L<span 
class="small-caps">I</span><span 
class="small-caps">U</span>, Z., L<span 
class="small-caps">I</span><span 
class="small-caps">N</span>, R., B<span 
class="small-caps">U</span>, R., H<span 
class="small-caps">E</span>, Z., Y<span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span>, Z., <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span> L<span 
class="small-caps">I</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span>, C.</span>
     Green grape detection and picking-point calculation in a night-time
     natural environment using a charge-coupled device (ccd) vision sensor
     with artificial illumination. <span 
class="pxi-x-x-109">Sensors 18</span>, 4 (2018).  <span id="textcolor36"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
     </p>
     <p class="bibitem" ><span class="biblabel">
 [37]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xcolor_shape_feat"></a><span 
class="pxsc-x-x-109">Z<span 
class="small-caps">A</span><span 
class="small-caps">W</span><span 
class="small-caps">B</span><span 
class="small-caps">A</span><span 
class="small-caps">A</span>,  H.,  A<span 
class="small-caps">B</span><span 
class="small-caps">B</span><span 
class="small-caps">A</span><span 
class="small-caps">S</span><span 
class="small-caps">S</span>,  M.,  H<span 
class="small-caps">A</span><span 
class="small-caps">Z</span><span 
class="small-caps">M</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span>,  M.,  <span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">D</span>  H<span 
class="small-caps">A</span><span 
class="small-caps">S</span><span 
class="small-caps">S</span><span 
class="small-caps">A</span><span 
class="small-caps">N</span><span 
class="small-caps">I</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span>,  A.</span><span 
class="pxsc-x-x-109">&#x00A0;E.</span>
     Automatic fruit image recognition system based on shape and color
     features.  <span 
class="pxi-x-x-109">Communications in Computer and Information Science 488 </span>(11
     2014), 278&#8211;290.  <span id="textcolor37"><span 
class="pxsy-x-x-109">&#x21D2;</span></span>
</p>
     </div>
                                                                    

                                                                    
   
</body></html> 

                                                                    


